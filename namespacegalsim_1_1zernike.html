<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GalSim: galsim.zernike Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GalSim
   &#160;<span id="projectnumber">2.0</span>
   </div>
   <div id="projectbrief">The modular galaxy image simulation toolkit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacegalsim.html">galsim</a></li><li class="navelem"><a class="el" href="namespacegalsim_1_1zernike.html">zernike</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">galsim.zernike Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1zernike_1_1_zernike.html">Zernike</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A class to represent a <a class="el" href="classgalsim_1_1zernike_1_1_zernike.html" title="A class to represent a Zernike polynomial series (http://en.wikipedia.org/wiki/Zernike_polynomials#Ze...">Zernike</a> polynomial series (<a href="http://en.wikipedia.org/wiki/Zernike_polynomials#Zernike_polynomials">http://en.wikipedia.org/wiki/Zernike_polynomials#Zernike_polynomials</a>).  <a href="classgalsim_1_1zernike_1_1_zernike.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a057d50715a610ad849d929083f7c43ba"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegalsim_1_1zernike.html#a057d50715a610ad849d929083f7c43ba">noll_to_zern</a> (j)</td></tr>
<tr class="memdesc:a057d50715a610ad849d929083f7c43ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert linear Noll index to tuple of <a class="el" href="classgalsim_1_1zernike_1_1_zernike.html" title="A class to represent a Zernike polynomial series (http://en.wikipedia.org/wiki/Zernike_polynomials#Ze...">Zernike</a> indices.  <a href="#a057d50715a610ad849d929083f7c43ba">More...</a><br /></td></tr>
<tr class="separator:a057d50715a610ad849d929083f7c43ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0db0712abc83dc477cd4b10ced7bcec4"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegalsim_1_1zernike.html#a0db0712abc83dc477cd4b10ced7bcec4">zernikeRotMatrix</a> (jmax, theta)</td></tr>
<tr class="memdesc:a0db0712abc83dc477cd4b10ced7bcec4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct <a class="el" href="classgalsim_1_1zernike_1_1_zernike.html" title="A class to represent a Zernike polynomial series (http://en.wikipedia.org/wiki/Zernike_polynomials#Ze...">Zernike</a> basis rotation matrix.  <a href="#a0db0712abc83dc477cd4b10ced7bcec4">More...</a><br /></td></tr>
<tr class="separator:a0db0712abc83dc477cd4b10ced7bcec4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17162b53a03c356403afb637e9578a44"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegalsim_1_1zernike.html#a17162b53a03c356403afb637e9578a44">zernikeBasis</a> (jmax, x, y, R_outer=1.0, R_inner=0.0)</td></tr>
<tr class="memdesc:a17162b53a03c356403afb637e9578a44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct basis of <a class="el" href="classgalsim_1_1zernike_1_1_zernike.html" title="A class to represent a Zernike polynomial series (http://en.wikipedia.org/wiki/Zernike_polynomials#Ze...">Zernike</a> polynomial series up to Noll index <code>jmax</code>, evaluated at a specific set of points <code>x</code> and <code>y</code>.  <a href="#a17162b53a03c356403afb637e9578a44">More...</a><br /></td></tr>
<tr class="separator:a17162b53a03c356403afb637e9578a44"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a057d50715a610ad849d929083f7c43ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a057d50715a610ad849d929083f7c43ba">&#9670;&nbsp;</a></span>noll_to_zern()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def galsim.zernike.noll_to_zern </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>j</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert linear Noll index to tuple of <a class="el" href="classgalsim_1_1zernike_1_1_zernike.html" title="A class to represent a Zernike polynomial series (http://en.wikipedia.org/wiki/Zernike_polynomials#Ze...">Zernike</a> indices. </p>
<p>j is the linear Noll coordinate, n is the radial <a class="el" href="classgalsim_1_1zernike_1_1_zernike.html" title="A class to represent a Zernike polynomial series (http://en.wikipedia.org/wiki/Zernike_polynomials#Ze...">Zernike</a> index and m is the azimuthal <a class="el" href="classgalsim_1_1zernike_1_1_zernike.html" title="A class to represent a Zernike polynomial series (http://en.wikipedia.org/wiki/Zernike_polynomials#Ze...">Zernike</a> index. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">j</td><td><a class="el" href="classgalsim_1_1zernike_1_1_zernike.html" title="A class to represent a Zernike polynomial series (http://en.wikipedia.org/wiki/Zernike_polynomials#Ze...">Zernike</a> mode Noll index </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>(n, m) tuple of <a class="el" href="classgalsim_1_1zernike_1_1_zernike.html" title="A class to represent a Zernike polynomial series (http://en.wikipedia.org/wiki/Zernike_polynomials#Ze...">Zernike</a> indices </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://oeis.org/A176988">https://oeis.org/A176988</a>. </dd></dl>

</div>
</div>
<a id="a17162b53a03c356403afb637e9578a44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17162b53a03c356403afb637e9578a44">&#9670;&nbsp;</a></span>zernikeBasis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def galsim.zernike.zernikeBasis </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>jmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>R_outer</em> = <code>1.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>R_inner</em> = <code>0.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct basis of <a class="el" href="classgalsim_1_1zernike_1_1_zernike.html" title="A class to represent a Zernike polynomial series (http://en.wikipedia.org/wiki/Zernike_polynomials#Ze...">Zernike</a> polynomial series up to Noll index <code>jmax</code>, evaluated at a specific set of points <code>x</code> and <code>y</code>. </p>
<p>Useful for fitting <a class="el" href="classgalsim_1_1zernike_1_1_zernike.html" title="A class to represent a Zernike polynomial series (http://en.wikipedia.org/wiki/Zernike_polynomials#Ze...">Zernike</a> polynomials to data, e.g., </p><pre class="fragment">  &gt;&gt;&gt; x, y, z = myDataToFit()
  &gt;&gt;&gt; basis = zernikeBasis(11, x, y)
  &gt;&gt;&gt; coefs, _, _, _ = np.linalg.lstsq(basis.T, z)
  &gt;&gt;&gt; resids = Zernike(coefs).evalCartesian(x, y) - z

  or equivalently

  &gt;&gt;&gt; resids = basis.T.dot(coefs).T - z
</pre><p>Note that since we follow the Noll indexing scheme for <a class="el" href="classgalsim_1_1zernike_1_1_zernike.html" title="A class to represent a Zernike polynomial series (http://en.wikipedia.org/wiki/Zernike_polynomials#Ze...">Zernike</a> polynomials, which begins at 1, but python sequences are indexed from 0, the length of the leading dimension in the result is <code>jmax+1</code> instead of <code>jmax</code>. We somewhat arbitrarily fill the 0th slice along the first dimension with 0s (result[0, ...] == 0) so that it doesn't impact the results of np.linalg.lstsq as in the example above.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jmax</td><td>Maximum Noll index to use. </td></tr>
    <tr><td class="paramname">x</td><td>x-coordinates (can be list-like, congruent to y) </td></tr>
    <tr><td class="paramname">y</td><td>y-coordinates (can be list-like, congruent to x) </td></tr>
    <tr><td class="paramname">R_outer</td><td>Outer radius. [default: 1.0] </td></tr>
    <tr><td class="paramname">R_inner</td><td>Inner radius. [default: 0.0] </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>[jmax+1, x.shape] array. Slicing over first index gives basis vectors corresponding to individual <a class="el" href="classgalsim_1_1zernike_1_1_zernike.html" title="A class to represent a Zernike polynomial series (http://en.wikipedia.org/wiki/Zernike_polynomials#Ze...">Zernike</a> polynomials. </dd></dl>

</div>
</div>
<a id="a0db0712abc83dc477cd4b10ced7bcec4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0db0712abc83dc477cd4b10ced7bcec4">&#9670;&nbsp;</a></span>zernikeRotMatrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def galsim.zernike.zernikeRotMatrix </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>jmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>theta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct <a class="el" href="classgalsim_1_1zernike_1_1_zernike.html" title="A class to represent a Zernike polynomial series (http://en.wikipedia.org/wiki/Zernike_polynomials#Ze...">Zernike</a> basis rotation matrix. </p>
<p>This matrix can be used to convert a set of <a class="el" href="classgalsim_1_1zernike_1_1_zernike.html" title="A class to represent a Zernike polynomial series (http://en.wikipedia.org/wiki/Zernike_polynomials#Ze...">Zernike</a> polynomial series coefficients expressed in one coordinate system to an equivalent set of coefficients expressed in a rotated coordinate system. For example: </p><pre class="fragment">&gt;&gt;&gt; Z = Zernike(coefs)
&gt;&gt;&gt; R = zernikeRotMatrix(jmax, theta)
&gt;&gt;&gt; rotCoefs = R.dot(coefs)
&gt;&gt;&gt; Zrot = Zernike(rotCoefs)
&gt;&gt;&gt; Z.evalPolar(r, th) == Zrot.evalPolar(r, th + theta)
</pre><p>Note that not all values of <code>jmax</code> are allowed. For example, jmax=2 raises an Exception, since a non-zero Z_2 coefficient will in general rotate into a combination of Z_2 and Z_3 coefficients, and therefore the needed rotation matrix requires jmax=3. If you run into this kind of Exception, raising jmax by 1 will eliminate it.</p>
<p>Also note that the returned matrix is intended to multiply a vector of <a class="el" href="classgalsim_1_1zernike_1_1_zernike.html" title="A class to represent a Zernike polynomial series (http://en.wikipedia.org/wiki/Zernike_polynomials#Ze...">Zernike</a> coefficients <code>coef</code> indexed following the Noll (1976) convention, which starts at 1. Since python sequences start at 0, we adopt the convention that <code>coef[0]</code> is unused, and <code>coef[i]</code> corresponds to the coefficient multiplying Z_i. As a result, the size of the returned matrix is [jmax+1, jmax+1].</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">jmax</td><td>Maximum <a class="el" href="classgalsim_1_1zernike_1_1_zernike.html" title="A class to represent a Zernike polynomial series (http://en.wikipedia.org/wiki/Zernike_polynomials#Ze...">Zernike</a> index (in the Noll convention) over which to construct matrix. </td></tr>
    <tr><td class="paramname">theta</td><td>Angle of rotation in radians. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Matrix of size [jmax+1, jmax+1]. </dd></dl>

</div>
</div>
</div><!-- contents -->
<hr class="footer"/><address class="footer"><small>
Generated for GalSim by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14</small></address>
</body>
</html>
