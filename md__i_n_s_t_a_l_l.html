<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>GalSim: Installation Instructions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">GalSim
   </div>
   <div id="projectbrief">The modular galaxy image simulation toolkit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Installation Instructions </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>System requirements: GalSim currently only supports Linux and Mac OSX.</p>
<p>Table of Contents:</p>
<p>0) <a href="#0-overall-summary">Overall summary</a></p>
<p>1) <a href="#1-software-required-before-building-galsim">Software required before building GalSim</a></p>
<p>2) <a href="#2-installing-the-galsim-python-package">Installing the GalSim Python package</a></p>
<p>3) <a href="#3-running-tests-and-installing-example-executables">Running tests and installing example executables</a></p>
<p>4) <a href="#4-running-example-scripts">Running example scripts</a></p>
<p>5) <a href="#5-platform-specific-notes">Platform-specific notes</a></p>
<p>6) <a href="#6-more-scons-options">More SCons options</a></p>
<h1>0. Overall summary </h1>
<p>While the sections below detail how to install GalSim including its required and optional dependencies, this section gives a brief summary. A minimal installation of GalSim requires the following dependencies. This dependency list includes a canonical version number that is known to work. In most cases, other recent versions will also work:</p>
<ul>
<li>Python (2.7, 3.4, 3.5, 3.6)</li>
<li>SCons (2.1.0)</li>
<li>NumPy (1.11)</li>
<li>Astropy (1.1.1)</li>
<li>Future (0.16.0)</li>
<li>FFTW (3.3)</li>
<li>TMV (0.73)</li>
<li>Boost (1.61)</li>
</ul>
<p>A few optional dependencies provide additional functionality, but GalSim can otherwise be compiled and used without them. Basic WCS functionality is native to GalSim, but for users with more complicated WCS needs, we recommend installing starlink-pyast. Thee Astropy WCS package is also supported, but note that it requires scipy as an additional dependency. To use yaml for config parsing, the pyyaml module is needed. Faster text file parsing for reading in bandpasses and SEDs can be enabled if you have the pandas module (but the code will work, albeit more slowly, without this module).</p>
<p>The sections below give a lot more details about how to obtain these dependencies; many are available from sources like pip or easy_install, rather than having to be installed from source. Third party packages like Anaconda often include many of these dependencies automatically. GalSim and all of its dependencies can be installed via fink, for users with Macs.</p>
<h1>1. Software required before building GalSim </h1>
<p>Please note: Mac users who want to use fink can skip down to Section 5.ii and use that to satisfy all dependencies before installing.</p>
<h2>i) Python (2.7, 3.4, 3.5, or 3.6 series), with some additional modules installed </h2>
<p>The interface to the GalSim code is via the Python package <code>galsim</code>, and its associated modules. Therefore you must have Python installed on your system. Python is free, and available from a number of sources online (see below). Currently GalSim supports Python versions 2.7, 3.4, 3.5, and 3.6. It is likely that other Python 3.x versions are compatible, but these two are the only ones actively tested.</p>
<p>Many systems have a version of Python pre-installed. To check whether you already have a compatible version, type </p>
<pre class="fragment">python --version
</pre><p>at the terminal prompt. If you get a "Command not found" error, or the reported version is not one of the supported versions, you should read the "Getting
Python and required modules" section below.</p>
<p>It may be that there is or soon will be more than one version of Python installed on your operating system, in which case please see the "Making sure
you are using the right Python" Section below.</p>
<h3>Getting Python and required modules</h3>
<p>For a list of places to download Python, see <a href="http://www.python.org/download/">http://www.python.org/download/</a>.</p>
<p>The GalSim package also requires</p>
<ul>
<li>the numerical Python module NumPy (<a href="http://www.numpy.org">http://www.numpy.org</a>). Currently GalSim is regularly tested to ensure it works with NumPy 1.11.2, but other versions will likely work.</li>
<li>the astronomical FITS file input/output module PyFITS available either as a standalone package: <a href="http://www.stsci.edu/institute/software_hardware/pyfits">http://www.stsci.edu/institute/software_hardware/pyfits</a> or as part of the astropy library: <a href="http://www.astropy.org/">http://www.astropy.org/</a> The latter is preferred, since this is now where all future development of this package is happening. Currently GalSim is regularly tested to ensure it works with astropy version 1.1.1, but it is likely that most recent versions will also work.</li>
<li>the future module, which is used to ease compatibility between Python 2 and Python 3. Currently GalSim is regularly tested to ensure it works with version 0.16.0 of this module, but other versions may work.</li>
<li>the PyYAML package for parsing YAML files (<a href="http://pyyaml.org/wiki/PyYAML">http://pyyaml.org/wiki/PyYAML</a>) Note: PyYAML is only technically required if you are using the <code>galsim</code> executable for parsing YAML config files. Users who will only use GalSim in Python (or use only JSON config files) may skip this dependency. Currently GalSim is regularly tested to ensure it works with version 3.12 of this package, but other versions may work.</li>
<li>Optional dependency: PyAst WCS package. This is a really nice front end for the Starlink AST astrometry code. It seems to support pretty much every WCS encoding there is. (At least every one we tried.) Their preferred installation method is via pip: pip install starlink-pyast For more information, see their website: <a href="https://pypi.python.org/pypi/starlink-pyast/">https://pypi.python.org/pypi/starlink-pyast/</a> With this installed, you can use the galsim.PyAstWCS class, which in turn means that galsim.FitsWCS will pretty much always work.</li>
<li>Optional dependency: Astropy WCS package. We already mentioned astropy above for astropy.io.fits. Another package we can use from astropy is their WCS package, astropy.wcs. They cannot read all that many WCS types (compared to PyAst at least), but hopefully the functionality will include in time. Unfortunately, this package has scipy as a dependency, which is kind of a gargantuan package. But if you are willing to install that too, then you can use the galsim.AstropyWCS class.</li>
<li>Optional dependency: Astropy Units package. This is now required for GalSim chromatic functionality, but can be omitted if you are not using this part of GalSim.</li>
<li>Optional dependency: Pandas. This has a very fast function for reading ASCII tables. If this is not available (e.g. when reading in Bandpass or SED files) then we fall back to the (much) slower numpy loadtxt function.</li>
</ul>
<p>These should installed onto your Python system so that they can be imported by: </p>
<pre class="fragment">&gt;&gt;&gt; import numpy
&gt;&gt;&gt; import astropy.io.fits  [ Either this (preferred)... ]
&gt;&gt;&gt; import pyfits           [ ... or this.               ]
&gt;&gt;&gt; import future
&gt;&gt;&gt; import yaml
&gt;&gt;&gt; import starlink.Ast     [ if planning to use PyAstWCS class ]
&gt;&gt;&gt; import astropy.wcs      [ if planning to use AstropyWCS class ]
&gt;&gt;&gt; import pandas           [ for faster ASCII table input ]
</pre><p>within Python. You can test this by loading up the Python interpreter for the version of Python you will be using with the GalSim toolkit. This is usually achieved by typing <code>python</code> or <code>/path/to/executable/bin/python</code> if your desired Python is not the system default, and typing the <code>import</code> commands above. If you get no warning message, things are OK.</p>
<p>If you do not have these modules, follow the links above or alternatively try <code>easy_install</code> (or equivalently <code>/path/to/executable/bin/easy_install</code> if your desired Python is not the default).</p>
<p>As an example, if using the default system Python, connected to the internet and with root/admin privileges simply type </p>
<pre class="fragment">easy_install numpy
easy_install pyfits
easy_install future
easy_install pyyaml
</pre><p>at the prompt. If not using an admin account, prefix the commands above with <code>sudo</code> and enter your admin password when prompted. The required modules should then be installed.</p>
<p>See <a href="http://packages.python.org/distribute/easy_install.html#using-easy-install">http://packages.python.org/distribute/easy_install.html#using-easy-install</a> for more details about the extremely useful <code>easy_install</code> feature.</p>
<p>Another option for installing these packages is pip. See pypi.python.org for details about getting this installed if you do not already have it on your system. Then </p>
<pre class="fragment">pip install numpy
pip install astropy
pip install future
pip install pyyaml
pip install starlink-pyast
pip install scipy
</pre><h3>Third party-maintained Python packages</h3>
<p>There are a number of third party-maintained packages which bundle Python with many of the numerical and scientific libraries that are commonly used, and many of these are free for non-commercial or academic use.</p>
<p>One good example of such a package, which includes all of the Python dependencies required by GalSim (NumPy, PyFITS, PyYAML as well as SCons and pytest; see Section 2 below) was the Enthought Python Distribution (EPD; see <a href="https://enthought.com/products/canopy/academic/">https://enthought.com/products/canopy/academic/</a> for the academic download instructions).</p>
<p>The new Enthought "Canopy" package, a successor to EPD, provides the same functionality. However, it has been found that Canopy on Mac OSX can give problems building against Boost.Python, another GalSim dependency. A solution to these issues is described here: <a href="https://github.com/GalSim-developers/GalSim/wiki/Installation-FAQ#wiki-canopy">https://github.com/GalSim-developers/GalSim/wiki/Installation-FAQ#wiki-canopy</a></p>
<p>Other re-packaged Python downloads can be found at <a href="http://www.python.org/download/">http://www.python.org/download/</a>.</p>
<h3>Making sure you are using the right Python</h3>
<p>Some users will find they have a few versions of Python around their operating system (determined, for example, using <code>locate python</code> at the prompt). A common way this will happen if there is already an older build (e.g. Python 2.4.X) being used by the operating system and then you install a newer version from one of the sources described above.</p>
<p>It will be important to make sure that the version of Python for which NumPy, PyFITS and PyYAML etc. are installed is also the one being used for GalSim, and that this is the one <em>you</em> want to use GalSim from! Knowing which installed version of Python will be used is also important for the installation of the Boost libraries (see Section 1.v, below).</p>
<p>To check which Python is your default you can identify the location of the executable by, for example, typing </p>
<pre class="fragment">which python
</pre><p>at the prompt. This will tell you the location of the executable, something like /path/to/executable/bin/python</p>
<p>If this is not the Python you want, please edit your startup scripts (e.g. <code>.profile</code> or <code>.bashrc</code>), and be sure to specify where your desired Python version resides when installing the Boost C++ libraries (see Section 1.v).</p>
<p>See Section 5 of this document for some suggestions about getting Python, Boost and all the other dependencies all working well together on your specific system.</p>
<h2>ii) SCons (<a href="http://www.scons.org">http://www.scons.org</a>) </h2>
<p>GalSim uses SCons to configure and run its installation procedures, and so SCons needs to be installed in advance. Versions 2.0 and 2.1 of SCons get reasonable testing with GalSim, but it should also work with 1.x versions. You can check if it is installed, and if so which version, by typing </p>
<pre class="fragment">scons --version
</pre><p>See Section 5 for some more suggestions about installing this on your platform.</p>
<h2>iii) FFTW (<a href="http://www.fftw.org">http://www.fftw.org</a>) </h2>
<p>These Fast Fourier Transform libraries must be installed, as GalSim will link to them during the build. We require version 3 (or greater presumably), which is often distributed as fftw3. See Section 5 for some suggestions about installing this on your platform.</p>
<h2>iv) TMV (<a href="https://github.com/rmjarvis/tmv/">https://github.com/rmjarvis/tmv/</a>) (version &gt;= 0.72 required) </h2>
<p>GalSim uses the TMV library for its linear algebra routines. You should download it from the site above and follow the instructions in its INSTALL file for how to install it. Usually installing TMV just requires the command </p>
<pre class="fragment">scons install PREFIX=&lt;installdir&gt;
</pre><p>but there are additional options you might consider, so you should read the TMV INSTALL file for full details. Also note, you may not need to specify the installation directory if you are comfortable installing it into <code>/usr/local</code>. However, if you are trying to install it into a system directory then you need to use sudo scons install [PREFIX=&lt;installdir&gt;].</p>
<p>Note: On Mac OS 10.7, the Apple BLAS library has problems when run using multiple processes. So if you have such a system, we recommend getting a different BLAS library, such as ATLAS (and making sure TMV finds it instead of the system BLAS) or compiling TMV with no BLAS library at all (using the SCons option <code>WITH_BLAS=false</code>). Otherwise, Galsim programs may hang when run with multiple processes. e.g. <code>scons tests</code> by default uses multiple processes, and multiple people reported problems using the Apple system BLAS on OS 10.7.</p>
<h2>v) Boost C++ (<a href="http://www.boost.org">http://www.boost.org</a>) </h2>
<p>GalSim makes use of some of the Boost C++ libraries, and these parts of Boost must be installed. Currently GalSim is regularly tested to ensure it works with Boost version 1.61, but it is likely that most versions released within the last several years will also work. It is particularly important that your installed Boost library links to the same version of Python with which you will be using GalSim and on which you have installed NumPy and PyFITS (see Section ii, above). Boost can be downloaded from the above website, and must be installed per the (rather limited) instructions there, which essentially amount to using a command </p>
<pre class="fragment">./bootstrap.sh
</pre><p>(Additional <code>bootstrap.sh</code> options may be necessary to ensure Boost is built against the correct version of Python; see below).</p>
<p>followed by </p>
<pre class="fragment">./b2 link=shared
./b2 --prefix=&lt;INSTALL_DIR&gt; link=shared install
</pre><p>If you are installing to a system directory, the second needs to be run as root, of course: <code>sudo ./b2</code>... Also, you should be aware that if you are running <code>b2</code> a second time, you should use <code>b2 -a</code> to tell boost to recompile everything rather than use the existing libraries.</p>
<p>The <code>link=shared</code> is necessary to ensure that they are built as shared libraries; this is automatic on some platforms, but not all.</p>
<p>Note: if you do not want to install everything related to Boost (which takes a while), you can restrict to Boost Python and math by using <code>--with-python</code> <code>--with-math</code> on the <code>./b2</code> commands. Currently we are only using Boost Python and parts of the math library so compiling and installing these two will likely be sufficient for the foreseeable future.</p>
<p>Once you have installed Boost, you can check that it links to the version of Python that will be used for GalSim and on which you have installed NumPy and PyFITS by typing </p>
<pre class="fragment">ldd &lt;YOUR_BOOST_LIB_DIR&gt;/libboost_python&lt;POSSIBLE_SUFFIX&gt;.so (Linux)
otool -L &lt;YOUR_BOOST_LIB_DIR&gt;/libboost_python&lt;POSSIBLE_SUFFIX&gt;.dylib (OSX)
</pre><p>(If the ldd command on Linux does not show the Python version, the command <code>ls -l &lt;YOUR_BOOST_LIB_LOCATION&gt;/libboost_python*</code> may show the version of libboost_python.so linked to, for example, <code>libboost_python_py26.so.1.40.0</code>. In such a case you can tell both the Python and Boost versions being used, 2.6 and <code>1.40.0</code>, respectively, in this example.) On some Linux systems, ldd will not indicate the Python library against which boost was compiled; in this case, continue with the installation procedure and any issues will be revealed at a later stage.</p>
<p>If the Python library listed is the one you will be using, all is well. If not, Boost can be forced to use a different version by specifying the following options to the ./bootstrap.sh installation script (defaults in <code>[]</code> brackets):</p>
<ul>
<li><code>--with-python=PYTHON</code> specify the Python executable [python]</li>
<li><code>--with-python-root=DIR</code> specify the root of the Python installation [automatically detected, but some users have found they have to force it to use a specific one because it detected the wrong one]</li>
</ul>
<h1>2. Installing the GalSim Python package </h1>
<p>Once you have installed all the dependencies described above, you are ready to build GalSim. From the GalSim base directory (in which this <a class="el" href="_i_n_s_t_a_l_l_8md.html">INSTALL.md</a> file is found) type </p>
<pre class="fragment">scons
</pre><p>If everything above was installed in fairly standard locations, this may work the first time. Otherwise, you may have to tell SCons where to find some of those libraries. There are quite a few options that you can use to tell SCons where to look, as well as other things about the build process. To see a list of options you can pass to SCons, type </p>
<pre class="fragment">scons -h
</pre><p>(See also Section 5 below.)</p>
<p>As an example, to specify where your TMV library is located, you can type </p>
<pre class="fragment">scons TMV_DIR=&lt;tmv-dir&gt;
</pre><p>where <code>&lt;tmv-dir&gt;</code> would be the same as the <code>PREFIX</code> you specified when installing TMV, i.e. The TMV library and include files are installed in <code>&lt;tmv-dir&gt;/lib</code> and <code>&lt;tmv-dir&gt;/include</code>. Some important options that you may need to set are:</p>
<ul>
<li><code>TMV_DIR</code>: Explicitly give the TMV prefix</li>
<li><code>FFTW_DIR</code>: Explicitly give the FFTW prefix</li>
<li><code>BOOST_DIR</code>: Explicitly give the Boost prefix</li>
<li><code>EXTRA_LIBS</code>: Additional libraries to send to the linker</li>
<li><code>EXTRA_INCLUDE_PATH</code>: Extra paths for header files (separated by : if more than 1)</li>
<li><code>EXTRA_FLAGS</code>: Extra flags to send to the compiler other than what is automatically used. (e.g. -m64 to force 64 bit compilation)</li>
</ul>
<p>Again, you can see the full list of options using <code>scons -h</code>.</p>
<p>Another common option is <code>CXX=&lt;c++compiler&gt;</code>. So, to compile with <code>icpc</code> rather than the default <code>g++</code>, type </p>
<pre class="fragment">scons CXX=icpc
</pre><p>On El Capitan, Apple instituted a new security measure wherein system calls lose some of the system environment variables, including DYLD_LIBRARY_PATH among others. If your system is set up to use that environment variable to resolve library locations at runtime, then this will cause problems when SCons is trying to figure out if things are installed correctly. To override this behavior, you can explicitly send this environment variable to SCons by writing </p>
<pre class="fragment">scons DYLD_LIBRARY_PATH=$DYLD_LIBRARY_PATH
</pre><p>and it will be able to re-set this value within the SCons processing.</p>
<p>One nice feature of SCons is that once you have specified a parameter, it will save that value for future builds in the file <code>gs_scons.conf</code>, so once you have the build process working, for later builds you only need to type <code>scons</code>. It can also be useful to edit this file directly &ndash; mostly if you want to unset a parameter and return to the default value, it can be easier to just delete the line from this file, rather than explicitly set it back to the default value.</p>
<p>SCons caches the results of the various checks it does for the required external libraries (TMV, Boost, etc.). This is usually very helpful, since they do not generally change, so it makes later builds much faster. However, sometimes (rarely) SCons can get confused and not realized that things on your system have changed, which might cause problems for you. You can delete everything scons knows about what it has tried to build previously with </p>
<pre class="fragment">/bin/rm -rf .scon*
</pre><p>This will force SCons to recheck and recompile everything from scratch.</p>
<p>Once you have a successful build, you can install the GalSim library, Python modules, and header files into standard locations (like <code>/usr/local</code> and your Python site-packages directory) with </p>
<pre class="fragment">scons install
</pre><p>or </p>
<pre class="fragment">sudo scons install
</pre><p>If you want to install into a different location, the prefix for the library and header files can be specified with <code>PREFIX=&lt;installdir&gt;</code>, and the location for the Python modules can be specified with <code>PYPREFIX=&lt;pythondir&gt;</code>. So the command would be </p>
<pre class="fragment">scons install PREFIX=&lt;installdir&gt; PYPREFIX=&lt;pythondir&gt;
</pre><p>Note: if you specify a specific directory for the Python modules with PYPREFIX, this directory should be in the sys.path search path for the version of Python you are using. You can check with </p>
<pre class="fragment">python -c "import sys; print sys.path"
</pre><p>If your <code>PYPREFIX</code> directory is not there, then Python will not be able to find the installed galsim module. You should therefore add this directory to your PYTHONPATH environment variable. For example, if you use bash, then you should add the line </p>
<pre class="fragment">export PYTHONPATH=$PYTHONPATH:&lt;pythondir&gt;
</pre><p>where <code>&lt;pythondir&gt;</code> is the same directory you used above for <code>PYPREFIX</code>.</p>
<p>The installed files can be removed with the command </p>
<pre class="fragment">scons uninstall
</pre><p>Finally, to clean all compiled objects from the <code>GalSim</code> directory, you can use </p>
<pre class="fragment">scons -c
</pre><p>This is rather like a <code>make clean</code> command.</p>
<p>If you are having trouble with installing, you may find some helpful hints at the GalSim Installation FAQ page on the Wiki: <a href="https://github.com/GalSim-developers/GalSim/wiki/Installation%20FAQ">https://github.com/GalSim-developers/GalSim/wiki/Installation%20FAQ</a></p>
<p>You can ask also about your particular problem on stackoverflow.com. Some of the GalSim developers have automatic alerts set up for the tag 'galsim'. So yout can ask your question there, and there is a good chance that it will be answered. You might also try searching that site to see if anyone else asked about the same problem.</p>
<p>If you are still having trouble, please consider opening a new issue on the GalSim Github page at <a href="https://github.com/GalSim-developers/GalSim/issues">https://github.com/GalSim-developers/GalSim/issues</a> explaining what your particular problem is, and hopefully someone can help you figure out a solution.</p>
<h1>3. Running tests and installing example executables </h1>
<p>You can run our test suite by typing </p>
<pre class="fragment">scons tests
</pre><p>This should compile the test suite and run it. The tests of our C++ library will always be run, but we use <code>pytest</code> for our Python test suite, so that will only be run if <code>pytest</code> is present on your system. We do not require this as a dependency, since you can still do everything with the GalSim library without this. But it is required for a complete run of the test suite.</p>
<p>To install <code>pytest</code>, you can also use easy_install as described in Section 1 above (see also <a href="https://docs.pytest.org/en/latest/">https://docs.pytest.org/en/latest/</a>). Many third party- maintained Python distributions, such as the Enthought Python Distribution, include <code>pytest</code>.</p>
<p>By default, the python tests will use the pytest plugins <code>pytest-xdist</code> (for running tests in parallel) and <code>pytest-timeout</code> (to manage how much time each test is allowed to run). These plugins are usually installable using pip: </p>
<pre class="fragment">pip install pytest-xdist pytest-timeout
</pre><p>Sometimes the <code>--user</code> flag may be needed in the above command to make the plugins discoverable. If you want to run the python tests without these plugins (serially!), you can still do this via </p>
<pre class="fragment">scons tests -j1
</pre><p>Note: if your system does not have <code>pytest</code> installed, and you do not want to install it, you can run all the Python tests with the script run_all_tests in the <code>tests</code> directory. If this finishes without an error, then all the tests have passed.</p>
<h1>4. Running example scripts </h1>
<p>The <code>examples</code> directory has a series of demo scripts: </p>
<pre class="fragment">demo1.py, demo2.py, ...
</pre><p>These can be considered a tutorial on getting up to speed with GalSim. Reading through these in order will introduce you to how to use most of the features of GalSim in Python. To run these scripts, type (e.g.): </p>
<pre class="fragment">python demo1.py
</pre><p>You can also create executable versions of these scripts if you prefer by typing </p>
<pre class="fragment">scons examples
</pre><p>This will put executable versions (with the first line <code>#!/bin/env python</code>) in the <code>examples_bin</code> directory. (We do not include that first line by default, since you might specify a different python to be used. Running <code>scons examples</code> will put whatever python executable you specify after <code>#!</code>.)</p>
<p>There are also a corresponding set of config files: </p>
<pre class="fragment">demo1.yaml, demo2.yaml, ...
</pre><p>These files can be run using the executable <code>galsim</code>, and will produce the same output images as the Python scripts: </p>
<pre class="fragment">galsim demo1.yaml
</pre><p>They are also well commented, and can be considered a parallel tutorial for learning the config file usage of GalSim.</p>
<p>All demo scripts are designed to be run in the <code>GalSim/examples</code> directory. Some of them access files in subdirectories of the <code>examples</code> directory, so they would not work correctly from other locations.</p>
<h1>5. Platform-specific notes </h1>
<h2>i) Linux </h2>
<p>The vast majority of Linux distributions provide installable packages for most of our dependencies. In many cases, however, it is also necessary to install "-devel" or "-dev" packages (e.g. <code>python-dev</code> or <code>libboost-dev</code> on Debian- derivatives). However, as above we stress that you should make sure that the version of Python that Boost is built against must be the same as that you intend to use for running GalSim.</p>
<p>The solution may be to install Boost C++ manually. This can be done by following the instructions of Section 1.v), above.</p>
<h2>ii) Mac OSX 10.8 and earlier </h2>
<p>a) Use of Fink &ndash; the <code>fink</code> (<a href="http://www.finkproject.org">http://www.finkproject.org</a>) package management software is popular with Mac users. Once it is installed, you can get either most or all of the prerequisites using it, depending on whether you want to use GalSim with the fink version of Python (e.g. that in <code>/sw/bin/python</code>) or the system Python (<code>/usr/bin/python</code>) or something else still.</p>
<p>It is in general a good idea to update fink prior to installing any new modules: </p>
<pre class="fragment">fink selfupdate
fink update-all
</pre><p>If you are happy with running GalSim using the fink version of python 2.7, you can install everything with the following command: </p>
<pre class="fragment">fink install galsim
</pre><p>and it should just work. However, there are some caveats that are worth knowing about (assuming your fink installation is in <code>/sw</code>):</p>
<ol type="1">
<li>This will install GalSim as a module of the python2.7 installed by fink. This is not the default Python (usually <code>/usr/bin/python</code> or some other package, such as EPD, if installed). Any Python scripts you write that use the galsim module should therefore have <code>#!/sw/bin/python2.7</code> as the first line rather than the usual <code>#!/usr/bin/env python</code>. Similarly, if you want to use galsim in an interactive Python session, you should run <code>/sw/bin/python2.7</code> (simply <code>python2.7</code> may also work) rather than just <code>python</code>. (Of course, you can always change your <code>PATH</code> environment variable to make the fink Python the system default if you wish...)</li>
<li>The executable <code>galsim</code>, which parses YAML or JSON configuration files, will be installed in <code>/sw/bin</code>. You should not need to do anything special to use these, since <code>/sw/bin</code> should already be in your path if using fink.</li>
<li>If you want to run through the example scripts (such as the demo tutorials <code>demo1.py</code>, <code>demo2.py</code> etc. and the <code>.yaml</code> and <code>.json</code> config versions of the same demos), you will still need to download the GalSim tarball. But you can skip all the instructions above about installation and just use the fink version. So <code>python2.7 demo1.py</code> (assuming <code>which python2.7</code> is the fink one) and <code>galsim demo1.yaml</code> should run those scripts for you.</li>
<li>If you want to work with GalSim as a developer, rather than just a user, then you cannot use the fink-installed GalSim. However, the process above will have installed all the prerequisites. So <code>fink uninstall galsim</code> will leave you able to install GalSim using the master branch with: <pre class="fragment">scons TMV_DIR=/sw PYTHON=/sw/bin/python2.7 BOOST_DIR=/sw/opt/boost-1_58
</pre></li>
</ol>
<p>from within the repository base directory.</p>
<p>To run the unit tests, you will also need pytest, which you can also get from fink: </p>
<pre class="fragment">fink install pytest-py27
scons tests PYTEST=/sw/bin/pytest
</pre><p>If you want to use the system Python, or some other version, then the fink Python installations will not work. You will need to manually install NumPy, PyFITS, PyYAML and pytest, for example using easy_install, with your chosen Python.</p>
<p>For the system Python, you can use fink for Boost, but you will want a different package than the boost1.58.python27 that gets installed using <code>fink install galsim</code> above: </p>
<pre class="fragment">fink install scons fftw3 tmv0 boost1.58-systempython
pip install future
scons TMV_DIR=/sw BOOST_DIR=/sw/opt/boost-1_58
</pre><p>For other Python versions, the fink-installed Boost usually will not work, so you can only use fink for SCons, FFTW and TMV. So you will probably need to install Boost manually. This can be done by following the instructions of Section 1.v), above.</p>
<p>b) MacPorts &ndash; this is another popular Mac package management project (<a href="http://www.macports.org/">http://www.macports.org/</a>) with similar functionality to fink. Neither TMV nor GalSim are currently on the official MacPorts distribution list, so users cannot find them by searching the MacPorts site. However, it is possible to install both TMV and GalSim, plus the other dependencies of GalSim, using MacPorts following the instructions below.</p>
<p>It is in general a good idea to upgrade all modules, prior to installing any new modules: </p>
<pre class="fragment">sudo port selfupdate
sudo port upgrade outdated
</pre><p>Below is a list of steps to take to install GalSim using MacPorts: </p>
<pre class="fragment">i) Take the `Portfiles` from the GalSim repository:
https://github.com/GalSim-developers/GalSim/blob/master/devel/ports.tar.gz
(If you do not clone the repository, there is a "copy" button on the website
that you can use to download the file directly.)
ii) Place the file in your home directory.
iii) `tar xvzf ports.tar.gz`
iv) `cd ports`
v) `sudo portindex`
vi) `sudo port install python27`
vii) `sudo port select --set python python27`
viii) `sudo sh -c "echo file:///Users/username/ports &gt;&gt;
      /opt/local/etc/macports/sources.conf"`
ix) `sudo port install galsim`
x) Add /opt/local/lib to DYLD_LIBRARY_PATH
</pre><p>Some users may find that the last step results in an inability to import the GalSim module. In that case, you can clear that addition to DYLD_LIBRARY_PATH and instead add /opt/local/lib to DYLD_FALLBACK_LIBRARY_PATH.</p>
<p>Notes on MacPorts with Mac OS X 10.8: The use of <code>sudo</code> in the above commands may elicit an error message that says "dyld: DYLD_ environment variables being ignored because main executable
(/usr/bin/sudo) is setuid or setgid". This is the result of a bug in Mac OS X 10.8, and will not prevent the installation of GalSim with the above steps from being successful.</p>
<p>Notes on MacPorts version of gcc with Mac OS X 10.5.8: If you have installed a MacPorts version of gcc (e.g., "mp-gcc47"), it may not link correctly with the other MacPorts installed modules, which are compiled in the system gcc versions. To check what gcc versions are available to you, try the command </p>
<pre class="fragment">port select --list gcc
</pre><p>then switch to the system gcc version (either 4.0 or 4.2) with </p>
<pre class="fragment">sudo port select --set gcc gcc42
</pre><p>and compile GalSim with the system gcc.</p>
<p>c) Homebrew (<a href="http://mxcl.github.com/homebrew/">http://mxcl.github.com/homebrew/</a>) &ndash; another package manager for Max OSX. Currently GalSim is available on homebrew, so it (plus dependencies) should be installable via </p>
<pre class="fragment">brew tap camphogg/science
brew install gal-sim
</pre><h2>iii) Mac OSX 10.9 (Mavericks) </h2>
<p>Most of what applies above for earlier Mac OSX versions seems to apply for GalSim on Mavericks too, although not all combinations have yet been tested.</p>
<p>However, it has been found that GalSim and its dependencies can be sensitive (e.g. Issue #483) to the fact that under Mavericks the system <code>gcc</code> is NOT in fact the Gnu Compiler Collection, but in fact Clang masquerading as such. This can lead to problems when linking libraries, as described in the following GalSim Wiki FAQ item: <a href="https://github.com/GalSim-developers/GalSim/wiki/Installation-FAQ#wiki-what-should-i-do-about-undefined-symbols-for-architecture-x86_64-errors">https://github.com/GalSim-developers/GalSim/wiki/Installation-FAQ#wiki-what-should-i-do-about-undefined-symbols-for-architecture-x86_64-errors</a></p>
<p>The best success seems to be achieved in Mavericks by <em>explicitly</em> specifying <code>clang</code> and <code>clang++</code> as the compiler to GalSim and all its dependencies when building (as in the example above).</p>
<h2>iv) Docker </h2>
<p>Karen Ng has created a Docker file for containerizing GalSim. See her repo: </p>
<pre class="fragment">https://github.com/karenyyng/GalSim_dockerfile
</pre><p>for instructions about how to either use her image or create your own.</p>
<h1>6. More SCons options </h1>
<p>Here is a fairly complete list of the options you can pass to SCons to control the build process. The options are listed with their default value. You change them simply by specifying a different value on the command line.</p>
<p>For example: </p>
<pre class="fragment">scons CXX=icpc TMV_DIR=~
</pre><p>(Unlike autotools, SCons correctly expands ~ to your home directory.) You can list these options from the command line with </p>
<pre class="fragment">scons -h
</pre><h3>Basic flags about the C++ compilation (default values in parentheses)</h3>
<ul>
<li><code>CXX</code> (g++) specifies which C++ compiler to use.</li>
<li><code>FLAGS</code> ('') specifies the basic flags to pass to the compiler. The default behavior is to automatically choose good flags to use according to which kind of compiler you are using. This option overrides that and lets you specify exactly what flags to use.</li>
<li><code>EXTRA_FLAGS</code> ('') specifies some extra flags that you want to use in addition to the defaults that SCons determines on its own. Unlike the above option, this do not override the defaults, it just adds to them.</li>
<li><code>LINK_FLAGS</code> ('') specifies some extra flags at the linking step to use in addition to the defaults that SCons determines it needs on its own.</li>
<li><code>DEBUG</code> (True) specifies whether to keep the debugging assert statements in the compiled library code. They are not much of a performance hit, so it is generally worth keeping them in, but if you need to squeeze out every last bit of performance, you can set this to False.</li>
<li><code>EXTRA_DEBUG</code> (False) specifies whether to add a flag to keep the original code information in the compiled library (-g3 for g++ compiler). This increases the size of the compiled library, but makes debugging with things like gdb easier. Probably end users will never need to use this.</li>
<li><code>WARN</code> (False) specifies whether to add warning compiler flags such as <code>-Wall</code>.</li>
<li><code>PYTHON</code> (/usr/bin/env python) specifies which version of Python you are planning to use GalSim with. If you choose not to use the default here, then you need to remember to use the correct Python version</li>
</ul>
<h3>Flags about where to install the library and modules</h3>
<ul>
<li><code>PREFIX</code> (/usr/local) specifies where to install the library when running <code>scons install</code>.</li>
<li><code>PYPREFIX</code> ([your python dir]/site-packages) specifies where to install the Python modules when running <code>scons install</code>.</li>
<li><code>FINAL_PREFIX</code> (<code>PREFIX</code>) specifies the final installation prefix if different from PREFIX. (This is only needed for things like fink, where they install into a staging area first before copying over to the final location.)</li>
<li><code>WITH_UPS</code> (False) specified whether to install the ups directory for use with EUPS.</li>
</ul>
<h3>Flags that specify where to look for external libraries</h3>
<ul>
<li><code>TMV_DIR</code> ('') specifies the location of TMV if it is not in a standard location. This should be the same value as you used for PREFIX when installing TMV.</li>
<li><code>TMV_LINK</code> ('') specifies the location of the tmv-link file. Normally, this is in <code>TMV_DIR/share</code>, but if not, you can specify the correct location here.</li>
<li><code>FFTW_DIR</code> ('') specifies the root location of FFTW. The header files should be in <code>FFTW_DIR/include</code> and the library files in <code>FFTW_DIR/lib</code>.</li>
<li><code>BOOST_DIR</code> ('') specifies the root location of BOOST The header files should be in <code>BOOST_DIR/include/boost</code> and the library files in <code>BOOST_DIR/lib</code>.</li>
<li><code>EXTRA_INCLUDE_PATH</code> ('') specifies extra directories in which to search for header files in addition to the standard locations such as <code>/usr/include</code> and <code>/usr/local/include</code> and the ones derived from the above options. Sometimes the above options do not quite work, so you may need to specify other locations, which is what this option is for. These directories are specified as <code>-I</code> flags to the compiler. If you are giving multiple directories, they should be separated by colons.</li>
<li><code>EXTRA_LIB_PATH</code> ('') specifies extra directories in which to search for libraries in addition to the standard locations such as <code>/usr/lib</code> and <code>/usr/local/lib</code>. These directories are specified as <code>-L</code> flags to the linker. If you are giving multiple directories, they should be separated by colons. To add the library <code>/blah/libfoo.a</code>, specify <code>EXTRA_LIB_PATH=/blah/ EXTRA_LIBS=foo</code>.</li>
<li><code>EXTRA_PATH</code> ('') specifies directories in which to search for executables (notably the compiler, although you can also just give the full path in the CXX parameter) in addition to the standard locations such as <code>/usr/bin</code> and <code>/usr/local/bin</code>. If you are giving multiple directories, they should be separated by colons.</li>
<li><code>IMPORT_PATHS</code> (False) specifies whether to import extra path directories from the environment variables: <code>PATH</code>, <code>C_INCLUDE_PATH</code>, <code>LD_LIBRARY_PATH</code> and <code>LIBRARY_PATH</code>. If you have a complicated setup in which you use these environment variables to control everything, this can be an easy way to let SCons know about these locations.</li>
<li><code>IMPORT_ENV</code> (True) specifies whether to import the entire environment from the calling shell. The default is for SCons to use the same environment as the shell from which it is called. However, sometimes it can be useful to start with a clean environment and manually add paths for various things, in which case you would want to set this to False.</li>
<li><code>EXTRA_LIBS</code> ('') specifies libraries to use in addition to what SCons finds on its own. This might be useful if you have a non-standard name for one of the external libraries. e.g. If you want to use the Intel MKL library for the FFTW library, SCons will not automatically try that, so you could add those libraries here. If there is more than one, they should be quoted with spaces between the different libraries. e.g. <code>EXTRA_LIBS="mkl_intel mkl_intel_thread mkl_core"</code></li>
<li><code>IMPORT_PREFIX</code> (True) specifies whether to include the directories <code>PREFIX/include</code>, <code>PREFIX/lib</code> and <code>PREFIX/bin</code> as part of the standard path lists. Normally, you install everything in the same place, so it is useful to search those locations for some of the prerequisite packages, so the default is True. But occasionally, this might be inconvenient, so you can turn this feature off.</li>
<li><code>DYLD_LIBRARY_PATH</code> ('') Set the DYLD_LIBRARY_PATH inside of SCons. Particularly useful on El Capitan (and later), since Apple strips out DYLD_LIBRARY_PATH from the environment that SCons sees, so if you need it, this option enables SCons to set it back in for you by doing <code>scons DYLD_LIBRARY_PATH=$DYLD_LIBRARY_PATH</code>.</li>
<li><code>DYLD_FALLBACK_LIBRARY_PATH</code> ('') Set the DYLD_FALLBACK_LIBRARY_PATH inside of SCons. cf. DYLD_LIBRARY_PATH for why this may be useful.</li>
<li><code>LD_LIBRARY_PATH</code> ('') Set the LD_LIBRARY_PATH inside of SCons. cf. DYLD_LIBRARY_PATH for why this may be useful.</li>
</ul>
<h3>Miscellaneous flags</h3>
<ul>
<li><code>PYTEST</code> (pytest) specifies which version of pytest you want to use for running the unit tests. If you specified a non-default Python, then there is a possibility that the standard pytest executable in your path will not work (since it might be for a different version of Python). In that case, specify the correct pytest here.</li>
<li><code>CACHE_LIB</code> (True) specifies whether to cache the results of the library checks. While you are working one getting the prerequisites installed properly, it can be useful to set this to False to force SCons to redo all of its library checks each time. Once you have a successful build, you should set it back to True so that later builds can skip those checks.</li>
<li><code>WITH_PROF</code> (False) specifies whether to use the compiler flag <code>-pg</code> to include profiling info for <code>gprof</code>.</li>
<li><code>MEM_TEST</code> (False) specifies whether to test the code for memory leaks.</li>
<li><code>TMV_DEBUG</code> (False) specifies whether to turn on extra (slower) debugging statements within the TMV library.</li>
<li><code>USE_UNKNOWN_VARS</code> (False) specifies whether to accept scons parameters other than the ones listed here. Normally, another name would indicate a typo, so we catch it and let you know. But if you want to use other scons options that we did not list here, you would want to also set this to True. </li>
</ul>
</div></div><!-- contents -->
<hr class="footer"/><address class="footer"><small>
Generated for GalSim by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6</small></address>
</body>
</html>
