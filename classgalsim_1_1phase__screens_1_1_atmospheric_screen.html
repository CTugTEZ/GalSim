<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GalSim: galsim.phase_screens.AtmosphericScreen Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GalSim
   &#160;<span id="projectnumber">2.0</span>
   </div>
   <div id="projectbrief">The modular galaxy image simulation toolkit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacegalsim.html">galsim</a></li><li class="navelem"><a class="el" href="namespacegalsim_1_1phase__screens.html">phase_screens</a></li><li class="navelem"><a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html">AtmosphericScreen</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classgalsim_1_1phase__screens_1_1_atmospheric_screen-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">galsim.phase_screens.AtmosphericScreen Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>An atmospheric phase screen that can drift in the wind and evolves ("boils") over time.  
 <a href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aebbe77178fa457707c3f43b859c975f9"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#aebbe77178fa457707c3f43b859c975f9">__init__</a> (self, <a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#a3709fb3250c7cf26d6d7b19cd3bbb699">screen_size</a>, <a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#a00d2e511867ce2da844b9d818fd6951d">screen_scale</a>=None, <a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#ac003649c8d0a678571378f8e479b9994">altitude</a>=0.0, <a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#a81c85d14236a4b4439bd61d3abb5aaff">r0_500</a>=0.2, <a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#afe6c9fa47dcb3f3504eacc91588b1ed5">L0</a>=25.0, <a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#a63f18a3cadb8ef9587517425c7f1e0ed">vx</a>=0.0, <a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#a4cad66f070122a040e96e22dd42913a2">vy</a>=0.0, <a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#a2c783b45a6e2d9cc1b8387143a5abd73">alpha</a>=1.0, <a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#a398121275b11d1820b1333065a36b02d">time_step</a>=None, <a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#aee12ec6e7b66f6e6a41e11da35480e14">rng</a>=None, suppress_warning=False)</td></tr>
<tr class="separator:aebbe77178fa457707c3f43b859c975f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4947e3b5408586a65be6d0881051a6eb"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#a4947e3b5408586a65be6d0881051a6eb">__str__</a> (self)</td></tr>
<tr class="separator:a4947e3b5408586a65be6d0881051a6eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0bec1a0dd004c08a13268ec51b7eb4c"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#ae0bec1a0dd004c08a13268ec51b7eb4c">__repr__</a> (self)</td></tr>
<tr class="separator:ae0bec1a0dd004c08a13268ec51b7eb4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15d89d7c172e4e9ff7bf3f8476f5099a"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#a15d89d7c172e4e9ff7bf3f8476f5099a">__eq__</a> (self, other)</td></tr>
<tr class="separator:a15d89d7c172e4e9ff7bf3f8476f5099a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b2e910668668d9b1510070f9f41096f"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#a3b2e910668668d9b1510070f9f41096f">__hash__</a> (self)</td></tr>
<tr class="separator:a3b2e910668668d9b1510070f9f41096f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fd58da0a31b1a5cfabf46e0990d5b70"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#a6fd58da0a31b1a5cfabf46e0990d5b70">__ne__</a> (self, other)</td></tr>
<tr class="separator:a6fd58da0a31b1a5cfabf46e0990d5b70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7427e2dd6e6eec1891f3627c0aa13f18"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#a7427e2dd6e6eec1891f3627c0aa13f18">instantiate</a> (self, <a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#af284eba3e79cdcb7e88b229f5736ba03">kmin</a>=0., <a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#a434eccc59a0dbce861837ae10da3f40c">kmax</a>=np.inf, check=None)</td></tr>
<tr class="separator:a7427e2dd6e6eec1891f3627c0aa13f18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43890bdf64d3066ce4c52762a5673e8b"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#a43890bdf64d3066ce4c52762a5673e8b">wavefront</a> (self, u, v, t=None, theta=(0.0 *radians, 0.0 *radians))</td></tr>
<tr class="memdesc:a43890bdf64d3066ce4c52762a5673e8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute wavefront due to atmospheric phase screen.  <a href="#a43890bdf64d3066ce4c52762a5673e8b">More...</a><br /></td></tr>
<tr class="separator:a43890bdf64d3066ce4c52762a5673e8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fdf5f7c83f68218acc1e6b943364b09"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#a6fdf5f7c83f68218acc1e6b943364b09">wavefront_gradient</a> (self, u, v, t=None, theta=(0.0 *radians, 0.0 *radians))</td></tr>
<tr class="memdesc:a6fdf5f7c83f68218acc1e6b943364b09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute gradient of wavefront due to atmospheric phase screen.  <a href="#a6fdf5f7c83f68218acc1e6b943364b09">More...</a><br /></td></tr>
<tr class="separator:a6fdf5f7c83f68218acc1e6b943364b09"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:acdb3e9d17c53a0d700b917781320f490"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#acdb3e9d17c53a0d700b917781320f490">npix</a></td></tr>
<tr class="separator:acdb3e9d17c53a0d700b917781320f490"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00d2e511867ce2da844b9d818fd6951d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#a00d2e511867ce2da844b9d818fd6951d">screen_scale</a></td></tr>
<tr class="separator:a00d2e511867ce2da844b9d818fd6951d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3709fb3250c7cf26d6d7b19cd3bbb699"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#a3709fb3250c7cf26d6d7b19cd3bbb699">screen_size</a></td></tr>
<tr class="separator:a3709fb3250c7cf26d6d7b19cd3bbb699"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac003649c8d0a678571378f8e479b9994"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#ac003649c8d0a678571378f8e479b9994">altitude</a></td></tr>
<tr class="separator:ac003649c8d0a678571378f8e479b9994"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a398121275b11d1820b1333065a36b02d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#a398121275b11d1820b1333065a36b02d">time_step</a></td></tr>
<tr class="separator:a398121275b11d1820b1333065a36b02d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81c85d14236a4b4439bd61d3abb5aaff"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#a81c85d14236a4b4439bd61d3abb5aaff">r0_500</a></td></tr>
<tr class="separator:a81c85d14236a4b4439bd61d3abb5aaff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe6c9fa47dcb3f3504eacc91588b1ed5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#afe6c9fa47dcb3f3504eacc91588b1ed5">L0</a></td></tr>
<tr class="separator:afe6c9fa47dcb3f3504eacc91588b1ed5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63f18a3cadb8ef9587517425c7f1e0ed"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#a63f18a3cadb8ef9587517425c7f1e0ed">vx</a></td></tr>
<tr class="separator:a63f18a3cadb8ef9587517425c7f1e0ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cad66f070122a040e96e22dd42913a2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#a4cad66f070122a040e96e22dd42913a2">vy</a></td></tr>
<tr class="separator:a4cad66f070122a040e96e22dd42913a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c783b45a6e2d9cc1b8387143a5abd73"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#a2c783b45a6e2d9cc1b8387143a5abd73">alpha</a></td></tr>
<tr class="separator:a2c783b45a6e2d9cc1b8387143a5abd73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad67ca2b0cd4ac8cdc30b9ba1b674990d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#ad67ca2b0cd4ac8cdc30b9ba1b674990d">dynamic</a></td></tr>
<tr class="separator:ad67ca2b0cd4ac8cdc30b9ba1b674990d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4b6e7af8864ef19aec35ff516b32d05"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#ae4b6e7af8864ef19aec35ff516b32d05">reversible</a></td></tr>
<tr class="separator:ae4b6e7af8864ef19aec35ff516b32d05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af284eba3e79cdcb7e88b229f5736ba03"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#af284eba3e79cdcb7e88b229f5736ba03">kmin</a></td></tr>
<tr class="separator:af284eba3e79cdcb7e88b229f5736ba03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a434eccc59a0dbce861837ae10da3f40c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#a434eccc59a0dbce861837ae10da3f40c">kmax</a></td></tr>
<tr class="separator:a434eccc59a0dbce861837ae10da3f40c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee12ec6e7b66f6e6a41e11da35480e14"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#aee12ec6e7b66f6e6a41e11da35480e14">rng</a></td></tr>
<tr class="separator:aee12ec6e7b66f6e6a41e11da35480e14"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>An atmospheric phase screen that can drift in the wind and evolves ("boils") over time. </p>
<p>The initial phases and fractional phase updates are drawn from a von Karman power spectrum, which is defined by a Fried parameter that effectively sets the amplitude of the turbulence, and an outer scale beyond which the turbulence power flattens.</p>
<p><a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html" title="An atmospheric phase screen that can drift in the wind and evolves (&quot;boils&quot;) over time...">AtmosphericScreen</a> delays the actual instantiation of the phase screen array in memory until it is used for either drawing a PSF or querying the wavefront or wavefront gradient. This is to facilitate automatic truncation of the screen power spectrum depending on the use case. For example, when drawing a PhaseScreenPSF using Fourier methods, the entire power spectrum should generally be used. On the other hand, when drawing using photon-shooting and the geometric approximation, it's better to truncate the high-k modes of the power spectrum here so that they can be handled instead by a SecondKick object (which also happens automatically; see the PhaseScreenPSF docstring). (See Peterson et al. 2015 for more details about the second kick). Querying the wavefront or wavefront gradient will instantiate the screen using the full power spectrum.</p>
<p>This class will normally attempt to sanity check that the screen has been appropriately instantiated depending on the use case, i.e., depending on whether it's being used to draw with Fourier optics or geometric optics. If you want to turn this warning off, however, you can use the <code>suppress_warning</code> keyword argument.</p>
<p>If you wish to override the automatic truncation determination, then you can directly instantiate the phase screen array using the <a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#a7427e2dd6e6eec1891f3627c0aa13f18">AtmosphericScreen.instantiate()</a> method.</p>
<p>Note that once a screen has been instantiated with a particular set of truncation parameters, it cannot be re-instantiated with another set of parameters.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">screen_size</td><td>Physical extent of square phase screen in meters. This should be large enough to accommodate the desired field-of-view of the telescope as well as the meta-pupil defined by the wind speed and exposure time. Note that the screen will have periodic boundary conditions, so while the code will still run with a small screen, this may introduce artifacts into PSFs or PSF correlation functions. Also note that screen_size may be tweaked by the initializer to ensure <code>screen_size</code> is a multiple of <code>screen_scale</code>. </td></tr>
    <tr><td class="paramname">screen_scale</td><td>Physical pixel scale of phase screen in meters. An order unity multiple of the Fried parameter is usually sufficiently small, but users should test the effects of varying this parameter to ensure robust results. [default: r0_500] </td></tr>
    <tr><td class="paramname">altitude</td><td>Altitude of phase screen in km. This is with respect to the telescope, not sea-level. [default: 0.0] </td></tr>
    <tr><td class="paramname">r0_500</td><td>Fried parameter setting the amplitude of turbulence; contributes to "size" of the resulting atmospheric PSF. Specified at wavelength 500 nm, in units of meters. [default: 0.2] </td></tr>
    <tr><td class="paramname">L0</td><td>Outer scale in meters. The turbulence power spectrum will smoothly approach a constant at scales larger than L0. Set to <code>None</code> or <code>np.inf</code> for a power spectrum without an outer scale. [default: 25.0] </td></tr>
    <tr><td class="paramname">vx</td><td>x-component wind velocity in meters/second. [default: 0.] </td></tr>
    <tr><td class="paramname">vy</td><td>y-component wind velocity in meters/second. [default: 0.] </td></tr>
    <tr><td class="paramname">alpha</td><td>Square root of fraction of phase that is "remembered" between time_steps (i.e., alpha**2 is the fraction remembered). The fraction sqrt(1-alpha**2) is then the amount of turbulence freshly generated in each step. Setting alpha=1.0 results in a frozen-flow atmosphere. Note that computing PSFs from frozen-flow atmospheres may be significantly faster than computing PSFs with non-frozen-flow atmospheres. If <code>alpha</code> != 1.0, then it is required that a <code>time_step</code> is also specified. [default: 1.0] </td></tr>
    <tr><td class="paramname">time_step</td><td>Time interval between phase boiling updates. Note that this is distinct from the time interval used to integrate the PSF over time, which is set by the <code>time_step</code> keyword argument to <code>PhaseScreenPSF</code> or <code><a class="el" href="classgalsim_1_1phase__psf_1_1_phase_screen_list.html#a74e16c6a773423fb0be7f813abd75bb0" title="Create a PSF from the current PhaseScreenList. ">PhaseScreenList.makePSF</a></code>. If <code>time_step</code> is not None, then it is required that <code>alpha</code> is set to something other than 1.0. [default: None] </td></tr>
    <tr><td class="paramname">rng</td><td>Random number generator as a <a class="el" href="classgalsim_1_1_base_deviate.html" title="Base class for all the various Deviates. ">galsim.BaseDeviate()</a>. If None, then use the clock time or system entropy to seed a new generator. [default: None] </td></tr>
    <tr><td class="paramname">suppress_warning</td><td>Turn off instantiation sanity checking. (See above) [default: False] <pre class="fragment">Relevant SPIE paper:
"Remembrance of phases past: An autoregressive method for generating realistic atmospheres in
simulations"
Srikar Srinath, Univ. of California, Santa Cruz;
Lisa A. Poyneer, Lawrence Livermore National Lab.;
Alexander R. Rudy, UCSC; S. Mark Ammons, LLNL
Published in Proceedings Volume 9148: Adaptive Optics Systems IV
September 2014</pre> </td></tr>
  </table>
  </dd>
</dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aebbe77178fa457707c3f43b859c975f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebbe77178fa457707c3f43b859c975f9">&#9670;&nbsp;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def galsim.phase_screens.AtmosphericScreen.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>screen_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>screen_scale</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>altitude</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>r0_500</em> = <code>0.2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>L0</em> = <code>25.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vx</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vy</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>alpha</em> = <code>1.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>time_step</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rng</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>suppress_warning</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a15d89d7c172e4e9ff7bf3f8476f5099a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15d89d7c172e4e9ff7bf3f8476f5099a">&#9670;&nbsp;</a></span>__eq__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def galsim.phase_screens.AtmosphericScreen.__eq__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>other</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3b2e910668668d9b1510070f9f41096f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b2e910668668d9b1510070f9f41096f">&#9670;&nbsp;</a></span>__hash__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def galsim.phase_screens.AtmosphericScreen.__hash__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6fd58da0a31b1a5cfabf46e0990d5b70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fd58da0a31b1a5cfabf46e0990d5b70">&#9670;&nbsp;</a></span>__ne__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def galsim.phase_screens.AtmosphericScreen.__ne__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>other</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae0bec1a0dd004c08a13268ec51b7eb4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0bec1a0dd004c08a13268ec51b7eb4c">&#9670;&nbsp;</a></span>__repr__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def galsim.phase_screens.AtmosphericScreen.__repr__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4947e3b5408586a65be6d0881051a6eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4947e3b5408586a65be6d0881051a6eb">&#9670;&nbsp;</a></span>__str__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def galsim.phase_screens.AtmosphericScreen.__str__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7427e2dd6e6eec1891f3627c0aa13f18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7427e2dd6e6eec1891f3627c0aa13f18">&#9670;&nbsp;</a></span>instantiate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def galsim.phase_screens.AtmosphericScreen.instantiate </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kmin</em> = <code>0.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kmax</em> = <code>np.inf</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>check</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">kmin</td><td>Minimum k-mode to include when generating phase screens. Generally this will only be used when testing the geometric approximation for atmospheric PSFs. [default: 0] </td></tr>
    <tr><td class="paramname">kmax</td><td>Maximum k-mode to include when generating phase screens. This may be used in conjunction with SecondKick to complete the geometric approximation for atmospheric PSFs. [default: np.inf] </td></tr>
    <tr><td class="paramname">check</td><td>Sanity check indicator. If equal to 'FFT', then check that phase screen Fourier modes are not being truncated, which is appropriate for full Fourier optics. If equal to 'phot', then check that phase screen Fourier modes <em>are</em> being truncated, which is appropriate for the geometric optics approximation. If <code>None</code>, then don't perform a check. Also, don't perform a check if self.suppress_warning is True. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a43890bdf64d3066ce4c52762a5673e8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43890bdf64d3066ce4c52762a5673e8b">&#9670;&nbsp;</a></span>wavefront()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def galsim.phase_screens.AtmosphericScreen.wavefront </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>theta</em> = <code>(0.0*radians,&#160;0.0*radians)</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute wavefront due to atmospheric phase screen. </p>
<p>Wavefront here indicates the distance by which the physical wavefront lags or leads the ideal plane wave.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">u</td><td>Horizontal pupil coordinate (in meters) at which to evaluate wavefront. Can be a scalar or an iterable. The shapes of u and v must match. </td></tr>
    <tr><td class="paramname">v</td><td>Vertical pupil coordinate (in meters) at which to evaluate wavefront. Can be a scalar or an iterable. The shapes of u and v must match. </td></tr>
    <tr><td class="paramname">t</td><td>Times (in seconds) at which to evaluate wavefront. Can be None, a scalar or an iterable. If None, then the internal time of the phase screens will be used for all u, v. If scalar, then the size will be broadcast up to match that of u and v. If iterable, then the shape must match the shapes of u and v. [default: None] </td></tr>
    <tr><td class="paramname">theta</td><td>Field angle at which to evaluate wavefront, as a 2-tuple of <code>galsim.Angle</code>s. [default: (0.0*galsim.arcmin, 0.0*galsim.arcmin)] Only a single theta is permitted. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Array of wavefront lag or lead in nanometers. </dd></dl>

</div>
</div>
<a id="a6fdf5f7c83f68218acc1e6b943364b09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fdf5f7c83f68218acc1e6b943364b09">&#9670;&nbsp;</a></span>wavefront_gradient()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def galsim.phase_screens.AtmosphericScreen.wavefront_gradient </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>t</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>theta</em> = <code>(0.0*radians,&#160;0.0*radians)</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute gradient of wavefront due to atmospheric phase screen. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">u</td><td>Horizontal pupil coordinate (in meters) at which to evaluate wavefront. Can be a scalar or an iterable. The shapes of u and v must match. </td></tr>
    <tr><td class="paramname">v</td><td>Vertical pupil coordinate (in meters) at which to evaluate wavefront. Can be a scalar or an iterable. The shapes of u and v must match. </td></tr>
    <tr><td class="paramname">t</td><td>Times (in seconds) at which to evaluate wavefront gradient. Can be None, a scalar or an iterable. If None, then the internal time of the phase screens will be used for all u, v. If scalar, then the size will be broadcast up to match that of u and v. If iterable, then the shape must match the shapes of u and v. [default: None] </td></tr>
    <tr><td class="paramname">theta</td><td>Field angle at which to evaluate wavefront, as a 2-tuple of <code>galsim.Angle</code>s. [default: (0.0*galsim.arcmin, 0.0*galsim.arcmin)] Only a single theta is permitted. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Arrays dWdu and dWdv of wavefront lag or lead gradient in nm/m. </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a2c783b45a6e2d9cc1b8387143a5abd73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c783b45a6e2d9cc1b8387143a5abd73">&#9670;&nbsp;</a></span>alpha</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">galsim.phase_screens.AtmosphericScreen.alpha</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac003649c8d0a678571378f8e479b9994"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac003649c8d0a678571378f8e479b9994">&#9670;&nbsp;</a></span>altitude</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">galsim.phase_screens.AtmosphericScreen.altitude</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad67ca2b0cd4ac8cdc30b9ba1b674990d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad67ca2b0cd4ac8cdc30b9ba1b674990d">&#9670;&nbsp;</a></span>dynamic</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">galsim.phase_screens.AtmosphericScreen.dynamic</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a434eccc59a0dbce861837ae10da3f40c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a434eccc59a0dbce861837ae10da3f40c">&#9670;&nbsp;</a></span>kmax</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">galsim.phase_screens.AtmosphericScreen.kmax</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af284eba3e79cdcb7e88b229f5736ba03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af284eba3e79cdcb7e88b229f5736ba03">&#9670;&nbsp;</a></span>kmin</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">galsim.phase_screens.AtmosphericScreen.kmin</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="afe6c9fa47dcb3f3504eacc91588b1ed5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe6c9fa47dcb3f3504eacc91588b1ed5">&#9670;&nbsp;</a></span>L0</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">galsim.phase_screens.AtmosphericScreen.L0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="acdb3e9d17c53a0d700b917781320f490"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdb3e9d17c53a0d700b917781320f490">&#9670;&nbsp;</a></span>npix</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">galsim.phase_screens.AtmosphericScreen.npix</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a81c85d14236a4b4439bd61d3abb5aaff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81c85d14236a4b4439bd61d3abb5aaff">&#9670;&nbsp;</a></span>r0_500</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">galsim.phase_screens.AtmosphericScreen.r0_500</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae4b6e7af8864ef19aec35ff516b32d05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4b6e7af8864ef19aec35ff516b32d05">&#9670;&nbsp;</a></span>reversible</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">galsim.phase_screens.AtmosphericScreen.reversible</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aee12ec6e7b66f6e6a41e11da35480e14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee12ec6e7b66f6e6a41e11da35480e14">&#9670;&nbsp;</a></span>rng</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">galsim.phase_screens.AtmosphericScreen.rng</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a00d2e511867ce2da844b9d818fd6951d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00d2e511867ce2da844b9d818fd6951d">&#9670;&nbsp;</a></span>screen_scale</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">galsim.phase_screens.AtmosphericScreen.screen_scale</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3709fb3250c7cf26d6d7b19cd3bbb699"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3709fb3250c7cf26d6d7b19cd3bbb699">&#9670;&nbsp;</a></span>screen_size</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">galsim.phase_screens.AtmosphericScreen.screen_size</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a398121275b11d1820b1333065a36b02d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a398121275b11d1820b1333065a36b02d">&#9670;&nbsp;</a></span>time_step</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">galsim.phase_screens.AtmosphericScreen.time_step</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a63f18a3cadb8ef9587517425c7f1e0ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63f18a3cadb8ef9587517425c7f1e0ed">&#9670;&nbsp;</a></span>vx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">galsim.phase_screens.AtmosphericScreen.vx</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4cad66f070122a040e96e22dd42913a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cad66f070122a040e96e22dd42913a2">&#9670;&nbsp;</a></span>vy</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">galsim.phase_screens.AtmosphericScreen.vy</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>galsim/<a class="el" href="phase__screens_8py.html">phase_screens.py</a></li>
</ul>
</div><!-- contents -->
<hr class="footer"/><address class="footer"><small>
Generated for GalSim by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14</small></address>
</body>
</html>
