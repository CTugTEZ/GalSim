<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>GalSim: galsim::hsm Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">GalSim
   </div>
   <div id="projectbrief">The modular galaxy image simulation toolkit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="namespacemembers.html"><span>Package&#160;Functions</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Properties</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacegalsim.html">galsim</a></li><li class="navelem"><a class="el" href="namespacegalsim_1_1hsm.html">hsm</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">galsim::hsm Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgalsim_1_1hsm_1_1_cpp_shape_data.html">CppShapeData</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Struct containing information about the shape of an object.  <a href="structgalsim_1_1hsm_1_1_cpp_shape_data.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgalsim_1_1hsm_1_1_h_s_m_params.html">HSMParams</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgalsim_1_1hsm_1_1_object_data.html">ObjectData</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Characterizes the shape and other parameters of objects.  <a href="structgalsim_1_1hsm_1_1_object_data.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1hsm_1_1_shape_data.html">ShapeData</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A class to contain the outputs of using the HSM shape and moments measurement routines.  <a href="classgalsim_1_1hsm_1_1_shape_data.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a20b000f241fd1c2a8f4f3b160254107b"><td class="memItemLeft" align="right" valign="top">const boost::shared_ptr<br class="typebreak"/>
&lt; <a class="el" href="structgalsim_1_1hsm_1_1_h_s_m_params.html">HSMParams</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegalsim_1_1hsm.html#a20b000f241fd1c2a8f4f3b160254107b">default_hsmparams</a> (new <a class="el" href="structgalsim_1_1hsm_1_1_h_s_m_params.html">HSMParams</a>())</td></tr>
<tr class="separator:a20b000f241fd1c2a8f4f3b160254107b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affac0466d7e41e5f9ee9ae8d54e8ff22"><td class="memTemplParams" colspan="2">template&lt;typename T , typename U &gt; </td></tr>
<tr class="memitem:affac0466d7e41e5f9ee9ae8d54e8ff22"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structgalsim_1_1hsm_1_1_cpp_shape_data.html">CppShapeData</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacegalsim_1_1hsm.html#affac0466d7e41e5f9ee9ae8d54e8ff22">EstimateShearView</a> (const <a class="el" href="classgalsim_1_1_base_image.html">BaseImage</a>&lt; T &gt; &amp;gal_image, const <a class="el" href="classgalsim_1_1_base_image.html">BaseImage</a>&lt; U &gt; &amp;PSF_image, const <a class="el" href="classgalsim_1_1_base_image.html">BaseImage</a>&lt; int &gt; &amp;gal_mask_image, float sky_var=0.0, const char *shear_est=&quot;REGAUSS&quot;, const std::string &amp;recompute_flux=&quot;FIT&quot;, double guess_sig_gal=5.0, double guess_sig_PSF=3.0, double precision=1.0e-6, galsim::Position&lt; double &gt; guess_centroid=galsim::Position&lt; double &gt;(-1000.,-1000.), boost::shared_ptr&lt; HSMParams &gt; hsmparams=boost::shared_ptr&lt; HSMParams &gt;())</td></tr>
<tr class="memdesc:affac0466d7e41e5f9ee9ae8d54e8ff22"><td class="mdescLeft">&#160;</td><td class="mdescRight">Carry out PSF correction directly using Images.  <a href="#affac0466d7e41e5f9ee9ae8d54e8ff22">More...</a><br/></td></tr>
<tr class="separator:affac0466d7e41e5f9ee9ae8d54e8ff22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6984a83d5ee1060aa555b9ebb973cbf5"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a6984a83d5ee1060aa555b9ebb973cbf5"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structgalsim_1_1hsm_1_1_cpp_shape_data.html">CppShapeData</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacegalsim_1_1hsm.html#a6984a83d5ee1060aa555b9ebb973cbf5">FindAdaptiveMomView</a> (const <a class="el" href="classgalsim_1_1_base_image.html">BaseImage</a>&lt; T &gt; &amp;object_image, const <a class="el" href="classgalsim_1_1_base_image.html">BaseImage</a>&lt; int &gt; &amp;object_mask_image, double guess_sig=5.0, double precision=1.0e-6, galsim::Position&lt; double &gt; guess_centroid=galsim::Position&lt; double &gt;(-1000.,-1000.), boost::shared_ptr&lt; HSMParams &gt; hsmparams=boost::shared_ptr&lt; HSMParams &gt;())</td></tr>
<tr class="memdesc:a6984a83d5ee1060aa555b9ebb973cbf5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Measure the adaptive moments of an object directly using Images.  <a href="#a6984a83d5ee1060aa555b9ebb973cbf5">More...</a><br/></td></tr>
<tr class="separator:a6984a83d5ee1060aa555b9ebb973cbf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ce66ba4ec411c491b53754a8fefb2ab"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegalsim_1_1hsm.html#a9ce66ba4ec411c491b53754a8fefb2ab">general_shear_estimator</a> (<a class="el" href="classgalsim_1_1_const_image_view.html">ConstImageView</a>&lt; double &gt; gal_image, <a class="el" href="classgalsim_1_1_const_image_view.html">ConstImageView</a>&lt; double &gt; PSF_image, <a class="el" href="structgalsim_1_1hsm_1_1_object_data.html">ObjectData</a> &amp;gal_data, <a class="el" href="structgalsim_1_1hsm_1_1_object_data.html">ObjectData</a> &amp;PSF_data, const std::string &amp;shear_est, unsigned long flags, boost::shared_ptr&lt; <a class="el" href="structgalsim_1_1hsm_1_1_h_s_m_params.html">HSMParams</a> &gt; hsmparams=boost::shared_ptr&lt; <a class="el" href="structgalsim_1_1hsm_1_1_h_s_m_params.html">HSMParams</a> &gt;())</td></tr>
<tr class="memdesc:a9ce66ba4ec411c491b53754a8fefb2ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Carry out PSF correction.  <a href="#a9ce66ba4ec411c491b53754a8fefb2ab">More...</a><br/></td></tr>
<tr class="separator:a9ce66ba4ec411c491b53754a8fefb2ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a410e4e192b19623616f6516ec77544b3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegalsim_1_1hsm.html#a410e4e192b19623616f6516ec77544b3">find_ellipmom_2</a> (<a class="el" href="classgalsim_1_1_const_image_view.html">ConstImageView</a>&lt; double &gt; data, double &amp;A, double &amp;x0, double &amp;y0, double &amp;Mxx, double &amp;Mxy, double &amp;Myy, double &amp;rho4, double convergence_threshold, int &amp;num_iter, boost::shared_ptr&lt; <a class="el" href="structgalsim_1_1hsm_1_1_h_s_m_params.html">HSMParams</a> &gt; hsmparams=boost::shared_ptr&lt; <a class="el" href="structgalsim_1_1hsm_1_1_h_s_m_params.html">HSMParams</a> &gt;())</td></tr>
<tr class="memdesc:a410e4e192b19623616f6516ec77544b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Measure the adaptive moments of an object.  <a href="#a410e4e192b19623616f6516ec77544b3">More...</a><br/></td></tr>
<tr class="separator:a410e4e192b19623616f6516ec77544b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e4df98f3d16186ddeeac25b3d1c50e8"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegalsim_1_1hsm.html#a3e4df98f3d16186ddeeac25b3d1c50e8">EstimateShear</a></td></tr>
<tr class="memdesc:a3e4df98f3d16186ddeeac25b3d1c50e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Carry out moments-based PSF correction routines.  <a href="#a3e4df98f3d16186ddeeac25b3d1c50e8">More...</a><br/></td></tr>
<tr class="separator:a3e4df98f3d16186ddeeac25b3d1c50e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a609965656c1fb90e664a6439312ac1fc"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegalsim_1_1hsm.html#a609965656c1fb90e664a6439312ac1fc">FindAdaptiveMom</a></td></tr>
<tr class="memdesc:a609965656c1fb90e664a6439312ac1fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Measure adaptive moments of an object.  <a href="#a609965656c1fb90e664a6439312ac1fc">More...</a><br/></td></tr>
<tr class="separator:a609965656c1fb90e664a6439312ac1fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a20b000f241fd1c2a8f4f3b160254107b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const boost::shared_ptr&lt;<a class="el" href="structgalsim_1_1hsm_1_1_h_s_m_params.html">HSMParams</a>&gt; galsim::hsm::default_hsmparams </td>
          <td>(</td>
          <td class="paramtype">new &#160;</td>
          <td class="paramname"><em>HSMParams</em>()</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a3e4df98f3d16186ddeeac25b3d1c50e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def galsim.hsm.EstimateShear </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gal_image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>PSF_image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>weight</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>badpix</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sky_var</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>shear_est</em> = <code>&quot;REGAUSS&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>recompute_flux</em> = <code>&quot;FIT&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>guess_sig_gal</em> = <code>5.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>guess_sig_PSF</em> = <code>3.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>precision</em> = <code>1.0e-6</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>guess_centroid</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>strict</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>hsmparams</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Carry out moments-based PSF correction routines. </p>
<p>Carry out PSF correction using one of the methods of the HSM package (see references in docstring for file <a class="el" href="hsm_8py.html" title="Routines for adaptive moment estimation and PSF correction. ">hsm.py</a>) to estimate galaxy shears, correcting for the convolution by the PSF.</p>
<p>This method works from Image inputs rather than GSObject inputs, which provides additional flexibility (e.g., it is possible to work from an Image that was read from file and corresponds to no particular GSObject), but this also means that users who wish to apply it to simple combinations of GSObjects (e.g., a Convolve) must take the additional step of drawing their GSObjects into Images.</p>
<p>This routine assumes that (at least locally) the WCS can be approximated as a PixelScale, with no distortion or non-trivial remapping. Any non-trivial WCS gets completely ignored.</p>
<p>Note that the method will fail if the PSF or galaxy are too point-like to easily fit an elliptical Gaussian; when running on batches of many galaxies, it may be preferable to set <code>strict=False</code> and catch errors explicitly, as in the second example below.</p>
<p>This function has a number of keyword parameters, many of which a typical user will not need to change from the default.</p>
<h2>Example usage </h2>
<p>Typical application to a single object: </p>
<pre class="fragment">&gt;&gt;&gt; galaxy = galsim.Gaussian(flux=1.0, sigma=1.0)
&gt;&gt;&gt; galaxy = galaxy.shear(g1=0.05, g2=0.0)  # shears the Gaussian by (0.05, 0) using the
&gt;&gt;&gt;                                         # |g| = (a-b)/(a+b) definition
&gt;&gt;&gt; psf = galsim.Kolmogorov(flux=1.0, fwhm=0.7)
&gt;&gt;&gt; final = galsim.Convolve(galaxy, psf)
&gt;&gt;&gt; final_image = final.drawImage(scale=0.2)
&gt;&gt;&gt; final_epsf_image = psf.drawImage(scale=0.2)
&gt;&gt;&gt; result = galsim.hsm.EstimateShear(final_image, final_epsf_image)
</pre><p>After running the above code, <code>result.observed_shape</code> is a galsim.Shear object with a value of <code>(0.0438925349133, -2.85747392701e-18)</code> and <code>result.corrected_e1</code>, <code>result_corrected_e2</code> are <code>(0.09934103488922119, -3.746108423463568e-10)</code>, compared with the expected <code>(0.09975, 0)</code> for a perfect PSF correction method.</p>
<p>The code below gives an example of how one could run this routine on a large batch of galaxies, explicitly catching and tracking any failures: </p>
<pre class="fragment">&gt;&gt;&gt; n_image = 100
&gt;&gt;&gt; n_fail = 0
&gt;&gt;&gt; for i=0, range(n_image):
&gt;&gt;&gt;     #...some code defining this_image, this_final_epsf_image...
&gt;&gt;&gt;     result = galsim.hsm.EstimateShear(this_image, this_final_epsf_image, strict=False)
&gt;&gt;&gt;     if result.error_message != "":
&gt;&gt;&gt;         n_fail += 1
&gt;&gt;&gt; print "Number of failures: ", n_fail
</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gal_image</td><td>The Image of the galaxy being measured. </td></tr>
    <tr><td class="paramname">PSF_image</td><td>The Image for the PSF. </td></tr>
    <tr><td class="paramname">weight</td><td>The optional weight image for the galaxy being measured. Can be an int or a float array. Currently, GalSim does not account for the variation in non-zero weights, i.e., a weight map is converted to an image with 0 and 1 for pixels that are not and are used. Full use of spatial variation in non-zero weights will be included in a future version of the code. </td></tr>
    <tr><td class="paramname">badpix</td><td>The optional bad pixel mask for the image being used. Zero should be used for pixels that are good, and any nonzero value indicates a bad pixel. </td></tr>
    <tr><td class="paramname">sky_var</td><td>The variance of the sky level, used for estimating uncertainty on the measured shape. [default: 0.] </td></tr>
    <tr><td class="paramname">shear_est</td><td>A string indicating the desired method of PSF correction: 'REGAUSS', 'LINEAR', 'BJ', or 'KSB'. The first three options return an e-type distortion, whereas the last option returns a g-type shear. [default: 'REGAUSS'] </td></tr>
    <tr><td class="paramname">recompute_flux</td><td>A string indicating whether to recompute the object flux, which should be 'NONE' (for no recomputation), 'SUM' (for recomputation via an unweighted sum over unmasked pixels), or 'FIT' (for recomputation using the Gaussian + quartic fit). [default: 'FIT'] </td></tr>
    <tr><td class="paramname">guess_sig_gal</td><td>Optional argument with an initial guess for the Gaussian sigma of the galaxy (in pixels). [default: 5.] </td></tr>
    <tr><td class="paramname">guess_sig_PSF</td><td>Optional argument with an initial guess for the Gaussian sigma of the PSF (in pixels). [default: 3.] </td></tr>
    <tr><td class="paramname">precision</td><td>The convergence criterion for the moments. [default: 1e-6] </td></tr>
    <tr><td class="paramname">guess_centroid</td><td>An initial guess for the object centroid (useful in case it is not located at the center, which is used if this keyword is not set). The convention for centroids is such that the center of the lower-left pixel is (image.xmin, image.ymin). [default: gal_image.trueCenter()] </td></tr>
    <tr><td class="paramname">strict</td><td>Whether to require success. If <code>strict=True</code>, then there will be a <code>RuntimeError</code> exception if shear estimation fails. If set to <code>False</code>, then information about failures will be silently stored in the output <a class="el" href="classgalsim_1_1hsm_1_1_shape_data.html" title="A class to contain the outputs of using the HSM shape and moments measurement routines. ">ShapeData</a> object. [default: True] </td></tr>
    <tr><td class="paramname">hsmparams</td><td>The hsmparams keyword can be used to change the settings used by <a class="el" href="namespacegalsim_1_1hsm.html#a3e4df98f3d16186ddeeac25b3d1c50e8" title="Carry out moments-based PSF correction routines. ">EstimateShear()</a> when estimating shears; see <a class="el" href="structgalsim_1_1hsm_1_1_h_s_m_params.html">HSMParams</a> documentation using help(<a class="el" href="structgalsim_1_1hsm_1_1_h_s_m_params.html">galsim.hsm.HSMParams</a>) for more information. [default: None]</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a <a class="el" href="classgalsim_1_1hsm_1_1_shape_data.html" title="A class to contain the outputs of using the HSM shape and moments measurement routines. ">ShapeData</a> object containing the results of shape measurement. </dd></dl>

</div>
</div>
<a class="anchor" id="affac0466d7e41e5f9ee9ae8d54e8ff22"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename U &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structgalsim_1_1hsm_1_1_cpp_shape_data.html">CppShapeData</a> galsim::hsm::EstimateShearView </td>
          <td>(</td>
          <td class="paramtype">const BaseImage&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>gal_image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const BaseImage&lt; U &gt; &amp;&#160;</td>
          <td class="paramname"><em>PSF_image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const BaseImage&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>gal_mask_image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>sky_var</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>shear_est</em> = <code>&quot;REGAUSS&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>recompute_flux</em> = <code>&quot;FIT&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>guess_sig_gal</em> = <code>5.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>guess_sig_PSF</em> = <code>3.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>precision</em> = <code>1.0e-6</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classgalsim_1_1_position.html">galsim::Position</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>guess_centroid</em> = <code><a class="el" href="classgalsim_1_1_position.html">galsim::Position</a>&lt;&#160;double&#160;&gt;(-1000.,-1000.)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boost::shared_ptr&lt; HSMParams &gt;&#160;</td>
          <td class="paramname"><em>hsmparams</em> = <code>boost::shared_ptr&lt;&#160;HSMParams&#160;&gt;()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Carry out PSF correction directly using Images. </p>
<p>A template function to carry out one of the multiple possible methods of PSF correction using the HSM package, directly accessing the input Images. The input arguments get repackaged before calling general_shear_estimator, and results for the shape measurement are returned as <a class="el" href="structgalsim_1_1hsm_1_1_cpp_shape_data.html" title="Struct containing information about the shape of an object. ">CppShapeData</a>. There are two arguments that have default values, namely shear_est (the type of shear estimator) and recompute_flux (for the REGAUSS method only).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">gal_image</td><td>The <a class="el" href="classgalsim_1_1_base_image.html" title="BaseImage class defines the interface of what you can do with Images without modifying pixels...">BaseImage</a> for the galaxy being measured </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PSF_image</td><td>The <a class="el" href="classgalsim_1_1_base_image.html" title="BaseImage class defines the interface of what you can do with Images without modifying pixels...">BaseImage</a> for the PSF </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gal_mask_image</td><td>The <a class="el" href="classgalsim_1_1_base_image.html" title="BaseImage class defines the interface of what you can do with Images without modifying pixels...">BaseImage</a> for the mask image to be applied to the galaxy being measured (integer array, 1=use pixel and 0=do not use pixel). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sky_var</td><td>The variance of the sky level, used for estimating uncertainty on the measured shape; default 0. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*shear_est</td><td>A string indicating the desired method of PSF correction: REGAUSS, LINEAR, BJ, or KSB; default REGAUSS. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*recompute_flux</td><td>A string indicating whether to recompute the object flux, which should be NONE (for no recomputation), SUM (for recomputation via an unweighted sum over unmasked pixels), or FIT (for recomputation using the Gaussian + quartic fit). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">guess_sig_gal</td><td>Optional argument with an initial guess for the Gaussian sigma of the galaxy, default 5.0 (pixels). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">guess_sig_PSF</td><td>Optional argument with an initial guess for the Gaussian sigma of the PSF, default 3.0 (pixels). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">precision</td><td>The convergence criterion for the moments; default 1e-6. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">guess_centroid</td><td>Optional argument with an initial guess for the centroid of the galaxy; if not set, then the code will try the center of the image. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hsmparams</td><td>Optional argument to specify parameters to be used for shape measurement routines, as an <a class="el" href="structgalsim_1_1hsm_1_1_h_s_m_params.html">HSMParams</a> object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <a class="el" href="structgalsim_1_1hsm_1_1_cpp_shape_data.html" title="Struct containing information about the shape of an object. ">CppShapeData</a> object containing the results of shape measurement. </dd></dl>

</div>
</div>
<a class="anchor" id="a410e4e192b19623616f6516ec77544b3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void galsim::hsm::find_ellipmom_2 </td>
          <td>(</td>
          <td class="paramtype">ConstImageView&lt; double &gt;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>y0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>Mxx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>Mxy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>Myy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>rho4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>convergence_threshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>num_iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boost::shared_ptr&lt; HSMParams &gt;&#160;</td>
          <td class="paramname"><em>hsmparams</em> = <code>boost::shared_ptr&lt;&#160;HSMParams&#160;&gt;()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Measure the adaptive moments of an object. </p>
<p>This function iteratively computes the adaptive moments of an image, and tells the user the results plus other diagnostic information. The key result is the best-fit elliptical Gaussian to the object, which is computed by initially guessing a circular Gaussian that is used as a weight function, computing the weighted moments, recomputing the moments using the result of the previous step as the weight function, and so on until the moments that are measured are the same as those used for the weight function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>The Image for the object being measured. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">A</td><td>The amplitude of the best-fit elliptical Gaussian (total image intensity for the Gaussian is 2A). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">x0</td><td>The x centroid of the best-fit elliptical Gaussian. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">y0</td><td>The y centroid of the best-fit elliptical Gaussian. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Mxx</td><td>The xx component of the moment matrix. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Mxy</td><td>The xy component of the moment matrix. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Myy</td><td>The yy component of the moment matrix. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rho4</td><td>The weighted radial fourth moment. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">convergence_threshold</td><td>The required level of accuracy. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">num_iter</td><td>The number of iterations needed to converge. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hsmparams</td><td>Optional argument to specify parameters to be used for shape measurement routines, as an <a class="el" href="structgalsim_1_1hsm_1_1_h_s_m_params.html">HSMParams</a> object. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a609965656c1fb90e664a6439312ac1fc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def galsim.hsm.FindAdaptiveMom </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>object_image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>weight</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>badpix</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>guess_sig</em> = <code>5.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>precision</em> = <code>1.0e-6</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>guess_centroid</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>strict</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>hsmparams</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Measure adaptive moments of an object. </p>
<p>This method estimates the best-fit elliptical Gaussian to the object (see Hirata &amp; Seljak 2003 for more discussion of adaptive moments). This elliptical Gaussian is computed iteratively by initially guessing a circular Gaussian that is used as a weight function, computing the weighted moments, recomputing the moments using the result of the previous step as the weight function, and so on until the moments that are measured are the same as those used for the weight function. <a class="el" href="namespacegalsim_1_1hsm.html#a609965656c1fb90e664a6439312ac1fc" title="Measure adaptive moments of an object. ">FindAdaptiveMom()</a> can be used either as a free function, or as a method of the Image class.</p>
<p>This routine assumes that (at least locally) the WCS can be approximated as a PixelScale, with no distortion or non-trivial remapping. Any non-trivial WCS gets completely ignored.</p>
<p>Like <a class="el" href="namespacegalsim_1_1hsm.html#a3e4df98f3d16186ddeeac25b3d1c50e8" title="Carry out moments-based PSF correction routines. ">EstimateShear()</a>, <a class="el" href="namespacegalsim_1_1hsm.html#a609965656c1fb90e664a6439312ac1fc" title="Measure adaptive moments of an object. ">FindAdaptiveMom()</a> works on Image inputs, and fails if the object is small compared to the pixel scale. For more details, see <a class="el" href="namespacegalsim_1_1hsm.html#a3e4df98f3d16186ddeeac25b3d1c50e8" title="Carry out moments-based PSF correction routines. ">EstimateShear()</a>.</p>
<h2>Example usage </h2>
<pre class="fragment">&gt;&gt;&gt; my_gaussian = galsim.Gaussian(flux=1.0, sigma=1.0)
&gt;&gt;&gt; my_gaussian_image = my_gaussian.drawImage(scale=0.2, method='no_pixel')
&gt;&gt;&gt; my_moments = galsim.hsm.FindAdaptiveMom(my_gaussian_image)
</pre><p>OR </p>
<pre class="fragment">&gt;&gt;&gt; my_moments = my_gaussian_image.FindAdaptiveMom()
</pre><p>Assuming a successful measurement, the most relevant pieces of information are <code>my_moments.moments_sigma</code>, which is <code>|det(M)|^(1/4)</code> [=<code>sigma</code> for a circular Gaussian] and <code>my_moments.observed_shape</code>, which is a Shear. In this case, <code>my_moments.moments_sigma</code> is precisely 5.0 (in units of pixels), and <code>my_moments.observed_shape</code> is consistent with zero.</p>
<p>Methods of the Shear class can be used to get the distortion <code>e</code>, the shear <code>g</code>, the conformal shear <code>eta</code>, and so on.</p>
<p>As an example of how to use the optional <code>hsmparams</code> argument, consider cases where the input images have unusual properties, such as being very large. This could occur when measuring the properties of a very over-sampled image such as that generated using </p>
<pre class="fragment">&gt;&gt;&gt; my_gaussian = galsim.Gaussian(sigma=5.0)
&gt;&gt;&gt; my_gaussian_image = my_gaussian.drawImage(scale=0.01, method='no_pixel')
</pre><p>If the user attempts to measure the moments of this very large image using the standard syntax, </p>
<pre class="fragment">&gt;&gt;&gt; my_moments = my_gaussian_image.FindAdaptiveMom()
</pre><p>then the result will be a RuntimeError due to moment measurement failing because the object is so large. While the list of all possible settings that can be changed is accessible in the docstring of the <a class="el" href="structgalsim_1_1hsm_1_1_h_s_m_params.html">HSMParams</a> class, in this case we need to modify <code>max_amoment</code> which is the maximum value of the moments in units of pixel^2. The following measurement, using the default values for every parameter except for <code>max_amoment</code>, will be successful: </p>
<pre class="fragment">&gt;&gt;&gt; new_params = galsim.hsm.HSMParams(max_amoment=5.0e5)
&gt;&gt;&gt; my_moments = my_gaussian_image.FindAdaptiveMom(hsmparams=new_params)
</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">object_image</td><td>The Image for the object being measured. </td></tr>
    <tr><td class="paramname">weight</td><td>The optional weight image for the object being measured. Can be an int or a float array. Currently, GalSim does not account for the variation in non-zero weights, i.e., a weight map is converted to an image with 0 and 1 for pixels that are not and are used. Full use of spatial variation in non-zero weights will be included in a future version of the code. [default: None] </td></tr>
    <tr><td class="paramname">badpix</td><td>The optional bad pixel mask for the image being used. Zero should be used for pixels that are good, and any nonzero value indicates a bad pixel. [default: None] </td></tr>
    <tr><td class="paramname">guess_sig</td><td>Optional argument with an initial guess for the Gaussian sigma of the object (in pixels). [default: 5.0] </td></tr>
    <tr><td class="paramname">precision</td><td>The convergence criterion for the moments. [default: 1e-6] </td></tr>
    <tr><td class="paramname">guess_centroid</td><td>An initial guess for the object centroid (useful in case it is not located at the center, which is used if this keyword is not set). The convention for centroids is such that the center of the lower-left pixel is (image.xmin, image.ymin). [default: object_image.trueCenter()] </td></tr>
    <tr><td class="paramname">strict</td><td>Whether to require success. If <code>strict=True</code>, then there will be a <code>RuntimeError</code> exception if shear estimation fails. If set to <code>False</code>, then information about failures will be silently stored in the output <a class="el" href="classgalsim_1_1hsm_1_1_shape_data.html" title="A class to contain the outputs of using the HSM shape and moments measurement routines. ">ShapeData</a> object. [default: True] </td></tr>
    <tr><td class="paramname">hsmparams</td><td>The hsmparams keyword can be used to change the settings used by FindAdaptiveMom when estimating moments; see <a class="el" href="structgalsim_1_1hsm_1_1_h_s_m_params.html">HSMParams</a> documentation using help(<a class="el" href="structgalsim_1_1hsm_1_1_h_s_m_params.html">galsim.hsm.HSMParams</a>) for more information. [default: None]</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a <a class="el" href="classgalsim_1_1hsm_1_1_shape_data.html" title="A class to contain the outputs of using the HSM shape and moments measurement routines. ">ShapeData</a> object containing the results of moment measurement. </dd></dl>

</div>
</div>
<a class="anchor" id="a6984a83d5ee1060aa555b9ebb973cbf5"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structgalsim_1_1hsm_1_1_cpp_shape_data.html">CppShapeData</a> galsim::hsm::FindAdaptiveMomView </td>
          <td>(</td>
          <td class="paramtype">const BaseImage&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>object_image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const BaseImage&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>object_mask_image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>guess_sig</em> = <code>5.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>precision</em> = <code>1.0e-6</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classgalsim_1_1_position.html">galsim::Position</a>&lt; double &gt;&#160;</td>
          <td class="paramname"><em>guess_centroid</em> = <code><a class="el" href="classgalsim_1_1_position.html">galsim::Position</a>&lt;&#160;double&#160;&gt;(-1000.,-1000.)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boost::shared_ptr&lt; HSMParams &gt;&#160;</td>
          <td class="paramname"><em>hsmparams</em> = <code>boost::shared_ptr&lt;&#160;HSMParams&#160;&gt;()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Measure the adaptive moments of an object directly using Images. </p>
<p>This function repackages the input <a class="el" href="classgalsim_1_1_base_image.html" title="BaseImage class defines the interface of what you can do with Images without modifying pixels...">BaseImage</a> in a format that find_ellipmom_2 accepts, in order to iteratively compute the adaptive moments of an object. The key result is the best-fit elliptical Gaussian to the object, which is computed by initially guessing a circular Gaussian that is used as a weight function, computing the weighted moments, recomputing the moments using the result of the previous step as the weight function, and so on until the moments that are measured are the same as those used for the weight function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">object_image</td><td>The <a class="el" href="classgalsim_1_1_base_image.html" title="BaseImage class defines the interface of what you can do with Images without modifying pixels...">BaseImage</a> for the object being measured. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">object_mask_image</td><td>The <a class="el" href="classgalsim_1_1_base_image.html" title="BaseImage class defines the interface of what you can do with Images without modifying pixels...">BaseImage</a> for the mask image to be applied to the object being measured (integer array, 1=use pixel and 0=do not use pixel). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">guess_sig</td><td>Optional argument with an initial guess for the Gaussian sigma of the object, default 5.0 (pixels). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">precision</td><td>The convergence criterion for the moments; default 1e-6. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">guess_centroid</td><td>Optional argument with an initial guess for the centroid of the galaxy; if not set, then the code will try the center of the image. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hsmparams</td><td>Optional argument to specify parameters to be used for shape measurement routines, as an <a class="el" href="structgalsim_1_1hsm_1_1_h_s_m_params.html">HSMParams</a> object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <a class="el" href="structgalsim_1_1hsm_1_1_cpp_shape_data.html" title="Struct containing information about the shape of an object. ">CppShapeData</a> object containing the results of moment measurement. </dd></dl>

</div>
</div>
<a class="anchor" id="a9ce66ba4ec411c491b53754a8fefb2ab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int galsim::hsm::general_shear_estimator </td>
          <td>(</td>
          <td class="paramtype">ConstImageView&lt; double &gt;&#160;</td>
          <td class="paramname"><em>gal_image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ConstImageView&lt; double &gt;&#160;</td>
          <td class="paramname"><em>PSF_image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ObjectData &amp;&#160;</td>
          <td class="paramname"><em>gal_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ObjectData &amp;&#160;</td>
          <td class="paramname"><em>PSF_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>shear_est</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boost::shared_ptr&lt; HSMParams &gt;&#160;</td>
          <td class="paramname"><em>hsmparams</em> = <code>boost::shared_ptr&lt;&#160;HSMParams&#160;&gt;()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Carry out PSF correction. </p>
<p>Carry out one of the multiple possible methods of PSF correction using the HSM package. Results for the shape measurement are returned by modifying the galaxy data directly. The flags parameter is only used for the REGAUSS shape measurement method, and is defined as follows: 0x1=recompute galaxy flux by summing unmasked pixels, 0x2=recompute galaxy flux from Gaussian-quartic fit, 0x4=cut off Gaussian approximator at NSIG_RG sigma to save time, 0x8=cut off PSF residual at NSIG_RG2 to save time. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">gal_image</td><td>The galaxy Image. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PSF_image</td><td>The PSF Image. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gal_data</td><td>The <a class="el" href="structgalsim_1_1hsm_1_1_object_data.html" title="Characterizes the shape and other parameters of objects. ">ObjectData</a> object for the galaxy </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PSF_data</td><td>The <a class="el" href="structgalsim_1_1hsm_1_1_object_data.html" title="Characterizes the shape and other parameters of objects. ">ObjectData</a> object for the PSF </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">shear_est</td><td>A string indicating the desired method of PSF correction: REGAUSS, LINEAR, BJ, or KSB. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>A parameter for REGAUSS (typical usage is 0xe). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hsmparams</td><td>Optional argument to specify parameters to be used for shape measurement routines, as an <a class="el" href="structgalsim_1_1hsm_1_1_h_s_m_params.html">HSMParams</a> object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A status flag that should be zero if the measurement was successful. </dd></dl>

</div>
</div>
</div><!-- contents -->
<hr class="footer"/><address class="footer"><small>
Generated for GalSim by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6</small></address>
</body>
</html>
