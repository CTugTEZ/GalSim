<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GalSim: include/galsim/integ/Int.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GalSim
   &#160;<span id="projectnumber">2.0</span>
   </div>
   <div id="projectbrief">The modular galaxy image simulation toolkit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_4e1e915d5079e084583082a570c3edeb.html">galsim</a></li><li class="navelem"><a class="el" href="dir_26693f7a087b7db42a3ccb6f2f3835f9.html">integ</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#namespaces">Namespaces</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Int.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A set of functions for doing integrals of functions which can be evaluated at arbitrary integrands. <br />
 Uses an adaptive Gauss-Kronrod-Patterson algorithm.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;functional&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &lt;queue&gt;</code><br />
<code>#include &lt;map&gt;</code><br />
<code>#include &lt;cmath&gt;</code><br />
<code>#include &lt;algorithm&gt;</code><br />
<code>#include &lt;cassert&gt;</code><br />
<code>#include &lt;limits&gt;</code><br />
<code>#include &lt;ostream&gt;</code><br />
<code>#include &lt;complex&gt;</code><br />
<code>#include &lt;stdexcept&gt;</code><br />
<code>#include &quot;galsim/Std.h&quot;</code><br />
<code>#include &quot;MoreFunctional.h&quot;</code><br />
<code>#include &quot;IntGKPData10.h&quot;</code><br />
</div>
<p><a href="_int_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgalsim_1_1integ_1_1_int_failure.html">galsim::integ::IntFailure</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">An exception type thrown if the integrator encounters a problem.  <a href="structgalsim_1_1integ_1_1_int_failure.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structgalsim_1_1integ_1_1_int_region.html">galsim::integ::IntRegion&lt; T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A type that encapsulates everything known about the integral in a region.  <a href="structgalsim_1_1integ_1_1_int_region.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespacegalsim"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegalsim.html">galsim</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacegalsim_1_1integ"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegalsim_1_1integ.html">galsim::integ</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a0cc3adeb5466ce22fddb289ef0924689"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_int_8h.html#a0cc3adeb5466ce22fddb289ef0924689">integ_dbg1</a>&#160;&#160;&#160;if (dbgout) (*dbgout)</td></tr>
<tr class="separator:a0cc3adeb5466ce22fddb289ef0924689"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18b574beefe6ea98797c91eb6045a739"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_int_8h.html#a18b574beefe6ea98797c91eb6045a739">integ_dbg2</a>&#160;&#160;&#160;if (reg.dbgout) (*reg.dbgout)</td></tr>
<tr class="separator:a18b574beefe6ea98797c91eb6045a739"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3930e446fb38950e18570ac555ae9bfb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_int_8h.html#a3930e446fb38950e18570ac555ae9bfb">integ_dbg3</a>&#160;&#160;&#160;if (tempreg.dbgout) (*tempreg.dbgout)</td></tr>
<tr class="separator:a3930e446fb38950e18570ac555ae9bfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3d3bb744d13233aa6ed138f2daf638f4"><td class="memTemplParams" colspan="2">template&lt;class UF &gt; </td></tr>
<tr class="memitem:a3d3bb744d13233aa6ed138f2daf638f4"><td class="memTemplItemLeft" align="right" valign="top">UF::result_type&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacegalsim_1_1integ.html#a3d3bb744d13233aa6ed138f2daf638f4">galsim::integ::int1d</a> (const UF &amp;func, IntRegion&lt; typename UF::result_type &gt; &amp;reg, const typename UF::result_type &amp;relerr=DEFRELERR, const typename UF::result_type &amp;abserr=DEFABSERR)</td></tr>
<tr class="memdesc:a3d3bb744d13233aa6ed138f2daf638f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform a 1-dimensional integral using an <a class="el" href="structgalsim_1_1integ_1_1_int_region.html" title="A type that encapsulates everything known about the integral in a region. ">IntRegion</a>.  <a href="namespacegalsim_1_1integ.html#a3d3bb744d13233aa6ed138f2daf638f4">More...</a><br /></td></tr>
<tr class="separator:a3d3bb744d13233aa6ed138f2daf638f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ea02caa245fb460c1975a73117fa55b"><td class="memTemplParams" colspan="2">template&lt;class UF &gt; </td></tr>
<tr class="memitem:a6ea02caa245fb460c1975a73117fa55b"><td class="memTemplItemLeft" align="right" valign="top">UF::result_type&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacegalsim_1_1integ.html#a6ea02caa245fb460c1975a73117fa55b">galsim::integ::int1d</a> (const UF &amp;func, typename UF::result_type min, typename UF::result_type max, const typename UF::result_type &amp;relerr=DEFRELERR, const typename UF::result_type &amp;abserr=DEFABSERR)</td></tr>
<tr class="memdesc:a6ea02caa245fb460c1975a73117fa55b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform a 1-dimensional integral using simple min/max values for the region.  <a href="namespacegalsim_1_1integ.html#a6ea02caa245fb460c1975a73117fa55b">More...</a><br /></td></tr>
<tr class="separator:a6ea02caa245fb460c1975a73117fa55b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af97f4fe50dc72a1c8c9e71b10c7518c5"><td class="memTemplParams" colspan="2">template&lt;class BF , class YREG &gt; </td></tr>
<tr class="memitem:af97f4fe50dc72a1c8c9e71b10c7518c5"><td class="memTemplItemLeft" align="right" valign="top">BF::result_type&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacegalsim_1_1integ.html#af97f4fe50dc72a1c8c9e71b10c7518c5">galsim::integ::int2d</a> (const BF &amp;func, IntRegion&lt; typename BF::result_type &gt; &amp;reg, const YREG &amp;yreg, const typename BF::result_type &amp;relerr=DEFRELERR, const typename BF::result_type &amp;abserr=DEFABSERR)</td></tr>
<tr class="memdesc:af97f4fe50dc72a1c8c9e71b10c7518c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform a 2-dimensional integral.  <a href="namespacegalsim_1_1integ.html#af97f4fe50dc72a1c8c9e71b10c7518c5">More...</a><br /></td></tr>
<tr class="separator:af97f4fe50dc72a1c8c9e71b10c7518c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c71cd3b756ac14c7c9f37968e3cada8"><td class="memTemplParams" colspan="2">template&lt;class TF , class YREG , class ZREG &gt; </td></tr>
<tr class="memitem:a9c71cd3b756ac14c7c9f37968e3cada8"><td class="memTemplItemLeft" align="right" valign="top">TF::result_type&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacegalsim_1_1integ.html#a9c71cd3b756ac14c7c9f37968e3cada8">galsim::integ::int3d</a> (const TF &amp;func, IntRegion&lt; typename TF::result_type &gt; &amp;reg, const YREG &amp;yreg, const ZREG &amp;zreg, const typename TF::result_type &amp;relerr=DEFRELERR, const typename TF::result_type &amp;abserr=DEFABSERR)</td></tr>
<tr class="memdesc:a9c71cd3b756ac14c7c9f37968e3cada8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform a 3-dimensional integral.  <a href="namespacegalsim_1_1integ.html#a9c71cd3b756ac14c7c9f37968e3cada8">More...</a><br /></td></tr>
<tr class="separator:a9c71cd3b756ac14c7c9f37968e3cada8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f6506bd322c63288443c20440d23bc4"><td class="memTemplParams" colspan="2">template&lt;class BF &gt; </td></tr>
<tr class="memitem:a2f6506bd322c63288443c20440d23bc4"><td class="memTemplItemLeft" align="right" valign="top">BF::result_type&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacegalsim_1_1integ.html#a2f6506bd322c63288443c20440d23bc4">galsim::integ::int2d</a> (const BF &amp;func, IntRegion&lt; typename BF::result_type &gt; &amp;reg, IntRegion&lt; typename BF::result_type &gt; &amp;yreg, const typename BF::result_type &amp;relerr=DEFRELERR, const typename BF::result_type &amp;abserr=DEFABSERR)</td></tr>
<tr class="separator:a2f6506bd322c63288443c20440d23bc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bb6ae99ad7f43ac52ec0bfaa4d6c2cc"><td class="memTemplParams" colspan="2">template&lt;class BF &gt; </td></tr>
<tr class="memitem:a5bb6ae99ad7f43ac52ec0bfaa4d6c2cc"><td class="memTemplItemLeft" align="right" valign="top">BF::result_type&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacegalsim_1_1integ.html#a5bb6ae99ad7f43ac52ec0bfaa4d6c2cc">galsim::integ::int2d</a> (const BF &amp;func, typename BF::result_type xmin, typename BF::result_type xmax, typename BF::result_type ymin, typename BF::result_type ymax, const typename BF::result_type &amp;relerr=DEFRELERR, const typename BF::result_type &amp;abserr=DEFABSERR)</td></tr>
<tr class="separator:a5bb6ae99ad7f43ac52ec0bfaa4d6c2cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a118acf87e934e6aa5246be34fb53bee5"><td class="memTemplParams" colspan="2">template&lt;class TF &gt; </td></tr>
<tr class="memitem:a118acf87e934e6aa5246be34fb53bee5"><td class="memTemplItemLeft" align="right" valign="top">TF::result_type&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacegalsim_1_1integ.html#a118acf87e934e6aa5246be34fb53bee5">galsim::integ::int3d</a> (const TF &amp;func, IntRegion&lt; typename TF::result_type &gt; &amp;reg, IntRegion&lt; typename TF::result_type &gt; &amp;yreg, IntRegion&lt; typename TF::result_type &gt; &amp;zreg, const typename TF::result_type &amp;relerr=DEFRELERR, const typename TF::result_type &amp;abserr=DEFABSERR)</td></tr>
<tr class="separator:a118acf87e934e6aa5246be34fb53bee5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1204da41b2e884765c4413078e0cbab"><td class="memTemplParams" colspan="2">template&lt;class TF &gt; </td></tr>
<tr class="memitem:aa1204da41b2e884765c4413078e0cbab"><td class="memTemplItemLeft" align="right" valign="top">TF::result_type&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacegalsim_1_1integ.html#aa1204da41b2e884765c4413078e0cbab">galsim::integ::int3d</a> (const TF &amp;func, typename TF::result_type xmin, typename TF::result_type xmax, typename TF::result_type ymin, typename TF::result_type ymax, typename TF::result_type zmin, typename TF::result_type zmax, const typename TF::result_type &amp;relerr=DEFRELERR, const typename TF::result_type &amp;abserr=DEFABSERR)</td></tr>
<tr class="separator:aa1204da41b2e884765c4413078e0cbab"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a823876295f18a560fd316d1ca898f6dd"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegalsim_1_1integ.html#a823876295f18a560fd316d1ca898f6dd">galsim::integ::MOCK_INF</a> = 1.e100</td></tr>
<tr class="memdesc:a823876295f18a560fd316d1ca898f6dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">May be used to indicate infinity in integration regions.  <a href="namespacegalsim_1_1integ.html#a823876295f18a560fd316d1ca898f6dd">More...</a><br /></td></tr>
<tr class="separator:a823876295f18a560fd316d1ca898f6dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fa295bf11bc65ba29364dbd462ab638"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegalsim_1_1integ.html#a4fa295bf11bc65ba29364dbd462ab638">galsim::integ::MOCK_INF2</a> = 1.e10</td></tr>
<tr class="memdesc:a4fa295bf11bc65ba29364dbd462ab638"><td class="mdescLeft">&#160;</td><td class="mdescRight">Anything larger than this is treated as infinity.  <a href="namespacegalsim_1_1integ.html#a4fa295bf11bc65ba29364dbd462ab638">More...</a><br /></td></tr>
<tr class="separator:a4fa295bf11bc65ba29364dbd462ab638"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57f4ec53f4130de1a009556c2f0a4a0e"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegalsim_1_1integ.html#a57f4ec53f4130de1a009556c2f0a4a0e">galsim::integ::DEFRELERR</a> = 1.e-6</td></tr>
<tr class="memdesc:a57f4ec53f4130de1a009556c2f0a4a0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The default target relative error if not specified.  <a href="namespacegalsim_1_1integ.html#a57f4ec53f4130de1a009556c2f0a4a0e">More...</a><br /></td></tr>
<tr class="separator:a57f4ec53f4130de1a009556c2f0a4a0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a4eacb397ce3c1b81526f500e0f5fd8"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegalsim_1_1integ.html#a8a4eacb397ce3c1b81526f500e0f5fd8">galsim::integ::DEFABSERR</a> = 1.e-12</td></tr>
<tr class="memdesc:a8a4eacb397ce3c1b81526f500e0f5fd8"><td class="mdescLeft">&#160;</td><td class="mdescRight">The default target absolute error if not specified.  <a href="namespacegalsim_1_1integ.html#a8a4eacb397ce3c1b81526f500e0f5fd8">More...</a><br /></td></tr>
<tr class="separator:a8a4eacb397ce3c1b81526f500e0f5fd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A set of functions for doing integrals of functions which can be evaluated at arbitrary integrands. <br />
 Uses an adaptive Gauss-Kronrod-Patterson algorithm. </p>
<p>Basic Usage: </p><pre class="fragment">First, define a function object, which should derive from 
std::unary_function&lt;double,double&gt;.  For example, to integrate a
Gaussian, use something along the lines of this:

class Gauss :
    public std::unary_function&lt;double,double&gt;
{   
public :

    Gauss(double _mu, double _sig) :   
        mu(_mu), sig(_sig), sigsq(_sig*_sig) {}

    double operator()(double x) const
    {
        const double SQRTTWOPI = 2.50662827463;
        return exp(-pow(x-mu,2)/2./sigsq)/SQRTTWOPI/sig;
    }

  private :
      double mu,sig,sigsq;
};


Then to perform an integral, over the range (min ... max) you would write:

double integ1 = integ::int1d(Gauss(mu,sigma),min,max);

e.g. integ::int1d(Gauss(0.,1.),0.,1.)

should yield a value of 0.68.

If either min or max are &gt; 1.e10 or &lt; -1.e10, then these values are taken to be
infinity / -infinity, rather than the actual value.  
So to integrate from 0 to infinity:

double integ2 = integ::int1d(Gauss(0.,2.),0.,1.e100);

which should yield a value of 0.5.  Or, you can also use the variable integ::MOCK_INF, 
which might be clearer.

There are two final arguments, which we've omitted so far, that can be used to specify
the precision required.  First the relative error, then the absolute error.
The defaults are 1.e-6 and 1.e-12 respectively, which are generally fine for most
purposes, but you can specify different values if you prefer.

The absolute error only comes into play for results which are close to 
0 to prevent requiring an error of 0 for integrals which evaluate to 0 
or very close to it.
</pre><p>Advanced Usage: </p><pre class="fragment">Sometimes it is useful to provide more information into how to split up a region
when the GKP algorithm fails to converge on the whole region.  To do this,
we need to start by making an IntRegion object.  e.g. the above integ1 integral
could use:

integ::IntRegion reg1(0.,1.);

And the above call could instead be called as:

int1d(Gauss(0.,1.), reg1);

For that integral, there is nothing weird going on, so the default works fine.
But when an integration fails to converge with the usual GKP algorithm,
it splits the region into 2 (or more) and tries again with each sub-region.
The default is to just bisect the region (or something similarly smart for
infinite regions), but if you know of a good place to split the region,
you can tell it using the method addSplit(x).
For example, if your integral has a singularity at 1/3, then it would help the 
program a lot to split there, so you can add a split point:

reg1.addSplit(1./3.);

Zeros of the integrand can also be good choices for splitting.

In addition to the integral being returned from int1d, int2d, or int3d as
the return value, the value is also stored in the region itself. 
You can access it using:

reg.getArea();

There is also an estimate of the error in the value:

reg.getErr();

(It is intended to be an overestimate of the actual error, 
but it doesn't always get it completely right.)
</pre><p>Two- and Three-Dimensional Integrals: </p><pre class="fragment">These are slightly more complicated.  The easiest case is when the
bounds of the integral are a rectangle or 3d box.  In this case,
you can still use the regular IntRegion.  The only new thing then
is the definition of the function.  For example, to integrate 
int(3x^2 + xy + y , x=0..1, y=0..1):

struct Integrand :
    public std::binary_function&lt;double,double,double&gt;
{
    double operator()(double x, double y) const { return x*(3.*x + y) + y; }
};

integ::IntRegion&lt;double&gt; reg3(0.,1.);
double integ3 = int2d(Integrand(),reg3,reg3);

(Which should give 1.75 as the result.)</pre></div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a0cc3adeb5466ce22fddb289ef0924689"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cc3adeb5466ce22fddb289ef0924689">&#9670;&nbsp;</a></span>integ_dbg1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define integ_dbg1&#160;&#160;&#160;if (dbgout) (*dbgout)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a18b574beefe6ea98797c91eb6045a739"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18b574beefe6ea98797c91eb6045a739">&#9670;&nbsp;</a></span>integ_dbg2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define integ_dbg2&#160;&#160;&#160;if (reg.dbgout) (*reg.dbgout)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3930e446fb38950e18570ac555ae9bfb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3930e446fb38950e18570ac555ae9bfb">&#9670;&nbsp;</a></span>integ_dbg3</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define integ_dbg3&#160;&#160;&#160;if (tempreg.dbgout) (*tempreg.dbgout)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a79e3b453d2571ed14110a426a914785a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79e3b453d2571ed14110a426a914785a">&#9670;&nbsp;</a></span>ir</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IntRegion&lt;T&gt; ir</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<hr class="footer"/><address class="footer"><small>
Generated for GalSim by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14</small></address>
</body>
</html>
