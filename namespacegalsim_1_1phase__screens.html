<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GalSim: galsim.phase_screens Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GalSim
   &#160;<span id="projectnumber">2.0</span>
   </div>
   <div id="projectbrief">The modular galaxy image simulation toolkit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacegalsim.html">galsim</a></li><li class="navelem"><a class="el" href="namespacegalsim_1_1phase__screens.html">phase_screens</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">galsim.phase_screens Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html">AtmosphericScreen</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">An atmospheric phase screen that can drift in the wind and evolves ("boils") over time.  <a href="classgalsim_1_1phase__screens_1_1_atmospheric_screen.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1phase__screens_1_1_optical_screen.html">OpticalScreen</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Class to describe optical aberrations in terms of Zernike polynomial coefficients.  <a href="classgalsim_1_1phase__screens_1_1_optical_screen.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1dd57e046cdafb16275642b2c1c27fd2"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegalsim_1_1phase__screens.html#a1dd57e046cdafb16275642b2c1c27fd2">Atmosphere</a> (screen_size, rng=None, _bar=None, kwargs)</td></tr>
<tr class="memdesc:a1dd57e046cdafb16275642b2c1c27fd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create an atmosphere as a list of turbulent phase screens at different altitudes.  <a href="#a1dd57e046cdafb16275642b2c1c27fd2">More...</a><br /></td></tr>
<tr class="separator:a1dd57e046cdafb16275642b2c1c27fd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a1dd57e046cdafb16275642b2c1c27fd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dd57e046cdafb16275642b2c1c27fd2">&#9670;&nbsp;</a></span>Atmosphere()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def galsim.phase_screens.Atmosphere </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>screen_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rng</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>_bar</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kwargs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create an atmosphere as a list of turbulent phase screens at different altitudes. </p>
<p>The atmosphere model can then be used to simulate atmospheric PSFs.</p>
<p>Simulating an atmospheric PSF is typically accomplished by first representing the 3-dimensional turbulence in the atmosphere as a series of discrete 2-dimensional phase screens. These screens may blow around in the wind, and may or may not also evolve in time. This function allows one to quickly assemble a list of atmospheric phase screens into a galsim.PhaseScreenList object, which can then be used to evaluate PSFs through various columns of atmosphere at different field angles.</p>
<p>The atmospheric screens currently available represent turbulence following a von Karman power spectrum. Specifically, the phase power spectrum in each screen can be written</p>
<p>psi(nu) = 0.023 r0^(-5/3) (nu^2 + 1/L0^2)^(11/6)</p>
<p>where psi(nu) is the power spectral density at spatial frequency nu, r0 is the Fried parameter (which has dimensions of length) and sets the amplitude of the turbulence, and L0 is the outer scale (also dimensions of length) beyond which the power asymptotically flattens. Typical values for r0 are ~0.1 to 0.2 meters, which corresponds roughly to PSF FWHMs of ~0.5 to 1.0 arcsec for optical wavelengths. Note that r0 is a function of wavelength, scaling like r0 ~ wavelength^(6/5). To reduce confusion, the input parameter here is named r0_500 and refers explicitly to the Fried parameter at a wavelength of 500 nm. The outer scale is typically in the 10s of meters and does not vary with wavelength.</p>
<p>To create multiple layers, simply specify keyword arguments as length-N lists instead of scalars (works for all arguments except <code>rng</code>). If, for any of these keyword arguments, you want to use the same value for each layer, then you can just specify the argument as a scalar and the function will automatically broadcast it into a list with length equal to the longest found keyword argument list. Note that it is an error to specify keywords with lists of different lengths (unless only one of them has length &gt; 1).</p>
<p>The one exception to the above is the keyword <code>r0_500</code>. The effective Fried parameter for a set of atmospheric layers is r0_500_effective = (sum(r**(-5./3) for r in r0_500s))**(-3./5). Providing <code>r0_500</code> as a scalar or single-element list will result in broadcasting such that the effective Fried parameter for the whole set of layers equals the input argument. You can weight the contribution of each layer with the <code>r0_weights</code> keyword.</p>
<p>As an example, the following code approximately creates the atmosphere used by Jee+Tyson(2011) for their study of atmospheric PSFs for LSST. Note this code takes about ~2 minutes to run on a fast laptop, and will consume about (8192**2 pixels) * (8 bytes) * (6 screens) ~ 3 GB of RAM in its final state, and more at intermediate states. </p><pre class="fragment">&gt;&gt;&gt; altitude = [0, 2.58, 5.16, 7.73, 12.89, 15.46]  # km
&gt;&gt;&gt; r0_500 = 0.16  # m
&gt;&gt;&gt; weights = [0.652, 0.172, 0.055, 0.025, 0.074, 0.022]
&gt;&gt;&gt; speed = np.random.uniform(0, 20, size=6)  # m/s
&gt;&gt;&gt; direction = [np.random.uniform(0, 360)*galsim.degrees for i in range(6)]
&gt;&gt;&gt; npix = 8192
&gt;&gt;&gt; screen_scale = r0_500
&gt;&gt;&gt; atm = galsim.Atmosphere(r0_500=r0_500, r0_weights=weights,
                            screen_size=screen_scale*npix,
                            altitude=altitude, L0=25.0, speed=speed,
                            direction=direction, screen_scale=screen_scale)
</pre><p>Once the atmosphere is constructed, a 15-sec exposure length, 5ms time step, monochromatic PSF at 700nm (using an 8.4 meter aperture, 0.6 fractional obscuration and otherwise default settings) takes about 7 minutes to draw on a fast laptop. </p><pre class="fragment">&gt;&gt;&gt; psf = atm.makePSF(lam=700.0, exptime=15.0, time_step=0.005, diam=8.4, obscuration=0.6)
&gt;&gt;&gt; img1 = psf.drawImage()  # ~7 min
</pre><p>The same psf, if drawn using photon-shooting on the same laptop, will generate photons at a rate of about 1 million per second. </p><pre class="fragment">&gt;&gt;&gt; img2 = psf.drawImage(nx=32, ny=32, scale=0.2, method='phot', n_photons=1e6)  # ~1 sec.
</pre><p>Note that the Fourier-based calculation compute time will scale linearly with exposure time, while the photon-shooting calculation compute time will scale linearly with the number of photons being shot.</p>
<p>Many factors will affect the timing of results, of course, including aperture diameter, gsparams settings, pad_factor and oversampling options to makePSF, time_step and exposure time, frozen vs. non-frozen atmospheric layers, and so on. We recommend that users try varying these settings to find a balance of speed and fidelity.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">r0_500</td><td>Fried parameter setting the amplitude of turbulence; contributes to "size" of the resulting atmospheric PSF. Specified at wavelength 500 nm, in units of meters. [default: 0.2] </td></tr>
    <tr><td class="paramname">r0_weights</td><td>Weights for splitting up the contribution of r0_500 between different layers. Note that this keyword is only allowed if r0_500 is either a scalar or a single-element list. [default: None] </td></tr>
    <tr><td class="paramname">screen_size</td><td>Physical extent of square phase screen in meters. This should be large enough to accommodate the desired field-of-view of the telescope as well as the meta-pupil defined by the wind speed and exposure time. Note that the screen will have periodic boundary conditions, so the code will run with a smaller sized screen, though this may introduce artifacts into PSFs or PSF correlation functions. Note that screen_size may be tweaked by the initializer to ensure screen_size is a multiple of screen_scale. </td></tr>
    <tr><td class="paramname">screen_scale</td><td>Physical pixel scale of phase screen in meters. A fraction of the Fried parameter is usually sufficiently small, but users should test the effects of this parameter to ensure robust results. [default: same as each screen's r0_500] </td></tr>
    <tr><td class="paramname">altitude</td><td>Altitude of phase screen in km. This is with respect to the telescope, not sea-level. [default: 0.0] </td></tr>
    <tr><td class="paramname">L0</td><td>Outer scale in meters. The turbulence power spectrum will smoothly approach a constant at scales larger than L0. Set to <code>None</code> or <code>np.inf</code> for a power spectrum without an outer scale. [default: 25.0] </td></tr>
    <tr><td class="paramname">speed</td><td>Wind speed in meters/second. [default: 0.0] </td></tr>
    <tr><td class="paramname">direction</td><td>Wind direction as galsim.Angle [default: 0.0 * galsim.degrees] </td></tr>
    <tr><td class="paramname">alpha</td><td>Square root of fraction of phase that is "remembered" between time_steps (i.e., alpha**2 is the fraction remembered). The fraction sqrt(1-alpha**2) is then the amount of turbulence freshly generated in each step. Setting alpha=1.0 results in a frozen-flow atmosphere. Note that computing PSFs from frozen-flow atmospheres may be significantly faster than computing PSFs with non-frozen-flow atmospheres. [default: 1.0] </td></tr>
    <tr><td class="paramname">time_step</td><td>Time interval between phase boiling updates. Note that this is distinct from the time interval used when integrating the PSF over time, which is set by the <code>time_step</code> keyword argument to <code>PhaseScreenPSF</code> or <code><a class="el" href="classgalsim_1_1phase__psf_1_1_phase_screen_list.html#a74e16c6a773423fb0be7f813abd75bb0" title="Create a PSF from the current PhaseScreenList. ">PhaseScreenList.makePSF</a></code>. If <code>time_step</code> is not None, then it is required that <code>alpha</code> is set to something other than 1.0. [default: None] </td></tr>
    <tr><td class="paramname">rng</td><td>Random number generator as a <a class="el" href="classgalsim_1_1_base_deviate.html" title="Base class for all the various Deviates. ">galsim.BaseDeviate()</a>. If None, then use the clock time or system entropy to seed a new generator. [default: None] </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<hr class="footer"/><address class="footer"><small>
Generated for GalSim by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14</small></address>
</body>
</html>
